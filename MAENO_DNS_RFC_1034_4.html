<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!-- saved from url=(0036)https://moin.qmail.jp/DNS/RFC/1034/4 -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="robots" content="index,nofollow">

<title>DNS/RFC/1034/4 - moin.qmail.jp</title>
<script type="text/javascript" src="./MAENO_DNS_RFC_1034_4_files/common.js.ダウンロード"></script>

<script type="text/javascript">
<!--
var search_hint = "検索";
//-->
</script>


<link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="./MAENO_DNS_RFC_1034_4_files/common.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="./MAENO_DNS_RFC_1034_4_files/screen.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="./MAENO_DNS_RFC_1034_4_files/print.css">
<link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="./MAENO_DNS_RFC_1034_4_files/projection.css">

<!-- css only for MS IE6/IE7 browsers -->
<!--[if lt IE 8]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/moin_static198/modern/css/msie.css">
<![endif]-->


<link rel="alternate" title="moin.qmail.jp: DNS/RFC/1034/4" href="https://moin.qmail.jp/DNS/RFC/1034/4?diffs=1&amp;show_att=1&amp;action=rss_rc&amp;unique=0&amp;page=DNS%2FRFC%2F1034%2F4&amp;ddiffs=1" type="application/rss+xml">


<link rel="Start" href="https://moin.qmail.jp/FrontPage">
<link rel="Alternate" title="Wikiマークアップ" href="https://moin.qmail.jp/DNS/RFC/1034/4?action=raw">
<link rel="Alternate" media="print" title="印刷ビュー" href="https://moin.qmail.jp/DNS/RFC/1034/4?action=print">
<link rel="Up" href="https://moin.qmail.jp/DNS/RFC/1034">
<link rel="Search" href="https://moin.qmail.jp/%E3%83%9A%E3%83%BC%E3%82%B8%E6%A4%9C%E7%B4%A2">
<link rel="Index" href="https://moin.qmail.jp/%E3%82%BF%E3%82%A4%E3%83%88%E3%83%AB%E3%82%A4%E3%83%B3%E3%83%87%E3%83%83%E3%82%AF%E3%82%B9">
<link rel="Glossary" href="https://moin.qmail.jp/%E5%8D%98%E8%AA%9E%E3%82%A4%E3%83%B3%E3%83%87%E3%83%83%E3%82%AF%E3%82%B9">
<link rel="Help" href="https://moin.qmail.jp/HelpOnFormatting">
</head>

<body lang="ja" dir="ltr">

<div id="header">
<div id="logo"><a href="https://moin.qmail.jp/FrontPage"><img src="./MAENO_DNS_RFC_1034_4_files/moinmoin.png" alt="MoinMoin Logo"></a></div>

<form id="searchform" method="get" action="https://moin.qmail.jp/DNS/RFC/1034/4">
<div>
<input type="hidden" name="action" value="fullsearch">
<input type="hidden" name="context" value="180">
<label for="searchinput" style="display: none;">検索:</label>
<input id="searchinput" type="text" name="value" value="" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search" class="disabled">
<input id="titlesearch" name="titlesearch" type="submit" value="タイトル" alt="Search Titles" disabled="">
<input id="fullsearch" name="fullsearch" type="submit" value="テキスト" alt="Search Full Text" disabled="">
</div>
</form>
<script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script>

<ul id="username"><li><a href="https://moin.qmail.jp/DNS/RFC/1034/4?action=login" id="login" rel="nofollow">ログイン</a></li></ul>
<div id="locationline">
<div id="interwiki"><span><a href="https://moin.qmail.jp/FrontPage" rel="nofollow">MoinqmailJp</a></span></div>

<ul id="pagelocation">
<li><a href="https://moin.qmail.jp/DNS">DNS</a></li><li><a href="https://moin.qmail.jp/DNS/RFC">RFC</a></li><li><a href="https://moin.qmail.jp/DNS/RFC/1034">1034</a></li><li><a href="https://moin.qmail.jp/DNS/RFC/1034/4">4</a></li>
</ul>

</div>


<ul id="navibar">
<li class="wikilink"><a href="https://moin.qmail.jp/%E6%9B%B4%E6%96%B0%E5%B1%A5%E6%AD%B4">更新履歴</a></li><li class="wikilink"><a href="https://moin.qmail.jp/%E3%83%9A%E3%83%BC%E3%82%B8%E6%A4%9C%E7%B4%A2">ページ検索</a></li><li class="wikilink"><a href="https://moin.qmail.jp/%E3%83%98%E3%83%AB%E3%83%97%E3%81%AE%E7%9B%AE%E6%AC%A1">ヘルプの目次</a></li><li class="wikilink"><a href="https://moin.qmail.jp/DNS/NEWS">DNS/NEWS</a></li><li class="userlink"><a href="https://moin.qmail.jp/Letsencrypt">Letsencrypt</a></li><li class="userlink"><a href="https://moin.qmail.jp/DNS">DNS</a></li><li class="current"><a href="https://moin.qmail.jp/DNS/RFC/1034/4">DNS/RFC/1034/4</a></li>
</ul>

<div id="pageline"><hr style="display:none;"></div>

<ul class="editbar"><li><span class="disabled">編集不可のページ</span></li><li class="toggleCommentsButton" style="display:none;"><a href="https://moin.qmail.jp/DNS/RFC/1034/4#" class="nbcomment" onclick="toggleComments();return false;">コメント</a></li><li><a class="nbinfo" href="https://moin.qmail.jp/DNS/RFC/1034/4?action=info" rel="nofollow">情報</a></li><li><a class="nbattachments" href="https://moin.qmail.jp/DNS/RFC/1034/4?action=AttachFile" rel="nofollow">添付ファイル</a></li><li>
<form class="actionsmenu" method="GET" action="https://moin.qmail.jp/DNS/RFC/1034/4">
<div>
    
    <select name="action" onchange="if ((this.selectedIndex != 0) &amp;&amp;
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show">その他のアクション:</option><option value="raw">Wikiテキスト</option>
<option value="print">印刷ビュー</option>
<option value="RenderAsDocbook">Docbookで表示</option>
<option value="refresh">キャッシュ削除</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="SpellCheck">スペルチェック</option>
<option value="LikePages">似たページ</option>
<option value="LocalSiteMap">ローカルサイトマップ</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="RenamePage" disabled="" class="disabled">ページ名変更</option>
<option value="CopyPage">ページコピー</option>
<option value="DeletePage" disabled="" class="disabled">ページ削除</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="MyPages">マイページ</option>
<option value="show" disabled="" class="disabled">購読ユーザ追加</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="show" disabled="" class="disabled">スパム削除</option>
<option value="show" disabled="" class="disabled">このリビジョンに戻す</option>
<option value="PackagePages">ページパッケージ化</option>
<option value="SyncPages">ページ同期</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="CreateNewPage">CreateNewPage</option>
<option value="Load">ロード</option>
<option value="PageActions">PageActions</option>
<option value="Save">保存</option>
<option value="SlideShow">SlideShow</option>
<option value="Thumbnails">Thumbnails</option>
    </select>
    
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('その他のアクション:');
//-->
</script>
</form>
</li></ul>

</div>

<div id="page" lang="ja" dir="ltr">
<div dir="ltr" id="content" lang="ja"><span class="anchor" id="top"></span>
<span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><p class="line874">目次より <span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span></p><p class="line874">4. ネームサーバ NAME SERVERS <span class="anchor" id="line-10"></span></p><ul><li style="list-style-type:none"><p class="line891"><a href="https://moin.qmail.jp/DNS/RFC/1034/4#A10">4.1. はじめに</a> Introduction<br>
 <span class="anchor" id="line-11"></span><a href="https://moin.qmail.jp/DNS/RFC/1034/4.2#A11">4.2. データベースをゾーンに分ける方法</a> How the database is divided into zones<br>
 <span class="anchor" id="line-12"></span></p><ul><li style="list-style-type:none"><p class="line891"><a href="https://moin.qmail.jp/DNS/RFC/1034/4.2#A12">4.2.1. 技術的事項</a> Technical considerations<br>
 <span class="anchor" id="line-13"></span><a href="https://moin.qmail.jp/DNS/RFC/1034/4.2#A13">4.2.2. 管理上の事項</a> Administrative considerations<br>
 <span class="anchor" id="line-14"></span></p></li></ul><p class="line891"><a href="https://moin.qmail.jp/DNS/RFC/1034/4.3#A14">4.3. ネームサーバの内部構成</a>  Name server internals<br>
 <span class="anchor" id="line-15"></span></p><ul><li style="list-style-type:none"><p class="line891"><a href="https://moin.qmail.jp/DNS/RFC/1034/4.3#A15">4.3.1. 問合せと返答</a> Queries and responses<br>
 <span class="anchor" id="line-16"></span><a href="https://moin.qmail.jp/DNS/RFC/1034/4.3#A16">4.3.2. アルゴリズム</a> Algorithm<br>
 <span class="anchor" id="line-17"></span><a href="https://moin.qmail.jp/DNS/RFC/1034/4.3#A17">4.3.3. ワイルドカード</a> Wildcards<br>
 <span class="anchor" id="line-18"></span><a href="https://moin.qmail.jp/DNS/RFC/1034/4.3#A18">4.3.4. 否定返答のキャッシュ(付加機能)</a> Negative response caching (Optional)<br>
 <span class="anchor" id="line-19"></span><a href="https://moin.qmail.jp/DNS/RFC/1034/4.3#A19">4.3.5. ゾーンの維持管理と転送</a> Zone maintenance and transfers<br>
 <span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span></p></li></ul></li></ul><p class="line867">
</p><h1 id="A4._.2BMM0w.2FDDgMLUw.2FDDQ-">4. ネームサーバ</h1>
<span class="anchor" id="line-22"></span><p class="line867"><span class="anchor" id="A10"></span> <span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span></p><p class="line867">
</p><h2 id="A4.1._.2BMG8wWDCBMGs__Introduction">4.1. はじめに  Introduction</h2>
<span class="anchor" id="line-25"></span><p class="line867"><span class="anchor" id="line-26"></span><span class="anchor" id="line-27"></span><span class="anchor" id="line-28"></span><span class="anchor" id="line-29"></span><span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span><span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span><span class="anchor" id="line-34"></span><span class="anchor" id="line-35"></span></p><pre><span class="anchor" id="line-1"></span>Name servers are the repositories of information that make up the domain
<span class="anchor" id="line-2"></span>database.  The database is divided up into sections called zones, which
<span class="anchor" id="line-3"></span>are distributed among the name servers.  While name servers can have
<span class="anchor" id="line-4"></span>several optional functions and sources of data, the essential task of a
<span class="anchor" id="line-5"></span>name server is to answer queries using data in its zones.  By design,
<span class="anchor" id="line-6"></span>name servers can answer queries in a simple manner; the response can
<span class="anchor" id="line-7"></span>always be generated using only local data, and either contains the
<span class="anchor" id="line-8"></span>answer to the question or a referral to other name servers ';closer'; to
<span class="anchor" id="line-9"></span>the desired information.</pre><span class="anchor" id="line-36"></span><p class="line874">ネームサーバはドメインデータベースを構成する情報の保管所である。 <span class="anchor" id="line-37"></span>データベースはゾーンと呼ばれる部分に分割されていて、 <span class="anchor" id="line-38"></span>ゾーンはネームサーバ間に分散されている。 <span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span></p><p class="line874">ネームサーバは実装任意の機能とデータ源を持てるが、 <span class="anchor" id="line-41"></span>本来の仕事はそのゾーン内にあるデータを使って問合せに答える事である。 <span class="anchor" id="line-42"></span><span class="anchor" id="line-43"></span></p><p class="line874">設計として、 <span class="anchor" id="line-44"></span>ネームサーバは単純な方法で問合せに答えることができる; <span class="anchor" id="line-45"></span>返答はローカルデータだけを使って常に生成できる。 <span class="anchor" id="line-46"></span>そして、返答は問合せに対する答か、 <span class="anchor" id="line-47"></span>求めている情報に「より近い」ネームサーバへの参照を含んでいる。 <span class="anchor" id="line-48"></span><span class="anchor" id="line-49"></span><span class="anchor" id="line-50"></span><span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span><span class="anchor" id="line-53"></span></p><pre><span class="anchor" id="line-1-1"></span>A given zone will be available from several name servers to insure its
<span class="anchor" id="line-2-1"></span>availability in spite of host or communication link failure.  By
<span class="anchor" id="line-3-1"></span>administrative fiat, we require every zone to be available on at least
<span class="anchor" id="line-4-1"></span>two servers, and many zones have more redundancy than that.</pre><span class="anchor" id="line-54"></span><p class="line874">ホストや通信リンクに障害があっても利用可能となるように <span class="anchor" id="line-55"></span>ゾーンは複数のネームサーバから利用可能とすべきである。 <span class="anchor" id="line-56"></span>管理上の命令として、ゾーンは 2つ以上のサーバで利用可能であることを要求している。 <span class="anchor" id="line-57"></span>そして、多くのゾーンはより多くの冗長性を持っている。 <span class="anchor" id="line-58"></span><span class="anchor" id="line-59"></span><span class="anchor" id="line-60"></span><span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span><span class="anchor" id="line-63"></span><span class="anchor" id="line-64"></span><span class="anchor" id="line-65"></span></p><pre><span class="anchor" id="line-1-2"></span>A given name server will typically support one or more zones, but this
<span class="anchor" id="line-2-2"></span>gives it authoritative information about only a small section of the
<span class="anchor" id="line-3-2"></span>domain tree.  It may also have some cached non-authoritative data about
<span class="anchor" id="line-4-2"></span>other parts of the tree.  The name server marks its responses to queries
<span class="anchor" id="line-5-1"></span>so that the requester can tell whether the response comes from
<span class="anchor" id="line-6-1"></span>authoritative data or not.</pre><span class="anchor" id="line-66"></span><p class="line874">ネームサーバはゾーン群をサポートするが、 <span class="anchor" id="line-67"></span>これにより、ドメイン木のほんの一部だけに権威ある情報を持つ。 <span class="anchor" id="line-68"></span>木の他の部分についてはキャッシュされた権威のないデータを持つことがある。 <span class="anchor" id="line-69"></span><span class="anchor" id="line-70"></span></p><p class="line874">返答が権威あるデータから来るものかどうか、問合せ側で判定できるように <span class="anchor" id="line-71"></span>ネームサーバは返答に印を付ける。 <span class="anchor" id="line-72"></span><span class="anchor" id="line-73"></span></p><p class="line867"><span class="anchor" id="A11"></span> <span class="anchor" id="line-74"></span>
</p><h2 id="A4.2._.2BMMcw.2FDC.2FMNkw.2FDC5MJIwvjD8MPMwa1IGMFEwi2W5bNU_How_the_database_is_divided_into_zones">4.2. データベースをゾーンに分ける方法 How the database is divided into zones</h2>
<span class="anchor" id="line-75"></span><p class="line867"><span class="anchor" id="line-76"></span><span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span></p><pre><span class="anchor" id="line-1-3"></span>The domain database is partitioned in two ways: by class, and by ';cuts';
<span class="anchor" id="line-2-3"></span>made in the name space between nodes.</pre><span class="anchor" id="line-79"></span><p class="line874">ドメインデータベースの分割法は二つある:クラスによる方法と名前空間を <span class="anchor" id="line-80"></span>ノードの間で「切る」という方法と。 <span class="anchor" id="line-81"></span><span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span><span class="anchor" id="line-84"></span><span class="anchor" id="line-85"></span><span class="anchor" id="line-86"></span><span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span><span class="anchor" id="line-89"></span><span class="anchor" id="line-90"></span></p><pre><span class="anchor" id="line-1-4"></span>The class partition is simple.  The database for any class is organized,
<span class="anchor" id="line-2-4"></span>delegated, and maintained separately from all other classes.  Since, by
<span class="anchor" id="line-3-3"></span>convention, the name spaces are the same for all classes, the separate
<span class="anchor" id="line-4-3"></span>classes can be thought of as an array of parallel namespace trees.  Note
<span class="anchor" id="line-5-2"></span>that the data attached to nodes will be different for these different
<span class="anchor" id="line-6-2"></span>parallel classes.  The most common reasons for creating a new class are
<span class="anchor" id="line-7-1"></span>the necessity for a new data format for existing types or a desire for a
<span class="anchor" id="line-8-1"></span>separately managed version of the existing name space.</pre><span class="anchor" id="line-91"></span><p class="line874">クラスによる分割は単純だ。 <span class="anchor" id="line-92"></span>[以下、翻訳は省略] <span class="anchor" id="line-93"></span><span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span><span class="anchor" id="line-96"></span><span class="anchor" id="line-97"></span><span class="anchor" id="line-98"></span><span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span><span class="anchor" id="line-101"></span></p><pre><span class="anchor" id="line-1-5"></span>Within a class, ';cuts'; in the name space can be made between any two
<span class="anchor" id="line-2-5"></span>adjacent nodes.  After all cuts are made, each group of connected name
<span class="anchor" id="line-3-4"></span>space is a separate zone.  The zone is said to be authoritative for all
<span class="anchor" id="line-4-4"></span>names in the connected region.  Note that the ';cuts'; 
<span class="anchor" id="line-5-3"></span>in the name space
<span class="anchor" id="line-6-3"></span>may be in different places for different classes, the name servers may
<span class="anchor" id="line-7-2"></span>be different, etc.</pre><span class="anchor" id="line-102"></span><p class="line874">ひとつのクラスの中では名前空間の「切断」は任意の隣接したノードの間で行ってよい。 <span class="anchor" id="line-103"></span><span class="anchor" id="line-104"></span></p><p class="line874">切断が行われた後に、連結されている名前空間のグループはそれぞれがひとつのゾーンとなる。 <span class="anchor" id="line-105"></span><span class="anchor" id="line-106"></span></p><p class="line874">ゾーンは連結されている領域に対しての権威をもつと言われる。 <span class="anchor" id="line-107"></span><span class="anchor" id="line-108"></span></p><p class="line874">名前空間での「切断」は異なるクラスでは異なる場所にあるかもしれない。 <span class="anchor" id="line-109"></span>また、ネームサーバも異なることがある、など。 <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span><span class="anchor" id="line-112"></span><span class="anchor" id="line-113"></span><span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span><span class="anchor" id="line-116"></span></p><pre><span class="anchor" id="line-1-6"></span>These rules mean that every zone has at least one node, and hence domain
<span class="anchor" id="line-2-6"></span>name, for which it is authoritative, and all of the nodes in a
<span class="anchor" id="line-3-5"></span>particular zone are connected.  Given, the tree structure, every zone
<span class="anchor" id="line-4-5"></span>has a highest node which is closer to the root than any other node in
<span class="anchor" id="line-5-4"></span>the zone.  The name of this node is often used to identify the zone.</pre><span class="anchor" id="line-117"></span><p class="line874">これらの規則が意味するのは、 <span class="anchor" id="line-118"></span>各ゾーンはドメイン名となるノードを含むひとつ以上のノードをもつこと、 <span class="anchor" id="line-119"></span>ゾーンはそれらのドメイン名に対して権威をもつこと、 <span class="anchor" id="line-120"></span>そして、ゾーン中のすべてのノードは連結されているということである。 <span class="anchor" id="line-121"></span><span class="anchor" id="line-122"></span></p><p class="line874">従って、ツリー構造をしているおのおののゾーンではゾーン中の他のノードよりも <span class="anchor" id="line-123"></span>ルートにより近い最上位ノードが存在する。 <span class="anchor" id="line-124"></span>このノードの名前がゾーンそのものを指すためによく使われる。 <span class="anchor" id="line-125"></span><span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span><span class="anchor" id="line-128"></span><span class="anchor" id="line-129"></span><span class="anchor" id="line-130"></span><span class="anchor" id="line-131"></span><span class="anchor" id="line-132"></span><span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span></p><pre><span class="anchor" id="line-1-7"></span>It would be possible, though not particularly useful, to partition the
<span class="anchor" id="line-2-7"></span>name space so that each domain name was in a separate zone or so that
<span class="anchor" id="line-3-6"></span>all nodes were in a single zone.  Instead, the database is partitioned
<span class="anchor" id="line-4-6"></span>at points where a particular organization wants to take over control of
<span class="anchor" id="line-5-5"></span>a subtree.  Once an organization controls its own zone it can
<span class="anchor" id="line-6-4"></span>unilaterally change the data in the zone, grow new tree sections
<span class="anchor" id="line-7-3"></span>connected to the zone, delete existing nodes, or delegate new subzones
<span class="anchor" id="line-8-2"></span>under its zone.</pre><span class="anchor" id="line-135"></span><p class="line874">特に役だつものではないが、名前空間を分割して <span class="anchor" id="line-136"></span>各ドメイン名が全て別のゾーンとすることも、 <span class="anchor" id="line-137"></span>全てのノードを含むひとつのゾーンとすることも可能である。 <span class="anchor" id="line-138"></span>それよりも、データベースは <span class="anchor" id="line-139"></span>組織が制御をひきとりたいような部分木に分れるように分割される。 <span class="anchor" id="line-140"></span>組織がそれ自身のゾーンを制御しはじめれば、 <span class="anchor" id="line-141"></span>ゾーン内のデータを独自に変更したり、 <span class="anchor" id="line-142"></span>ゾーンに新しい木を増やしたり、既存のノードを削除したり、 <span class="anchor" id="line-143"></span>自分の中に新しいサブゾーンを作って委譲したりすることができる。 <span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span><span class="anchor" id="line-146"></span><span class="anchor" id="line-147"></span><span class="anchor" id="line-148"></span><span class="anchor" id="line-149"></span></p><pre><span class="anchor" id="line-1-8"></span>If the organization has substructure, it may want to make further
<span class="anchor" id="line-2-8"></span>internal partitions to achieve nested delegations of name space control.
<span class="anchor" id="line-3-7"></span>In some cases, such divisions are made purely to make database
<span class="anchor" id="line-4-7"></span>maintenance more convenient.</pre><span class="anchor" id="line-150"></span><p class="line874">組織が下部構造を持つなら、 <span class="anchor" id="line-151"></span>名前空間の制御を委譲するということを多段に行い、 <span class="anchor" id="line-152"></span>さらに分割を行いたいであろう。 <span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span></p><p class="line874">データベース管理がより簡単になるという <span class="anchor" id="line-155"></span>理由だけでこのような分割が行われることがある。 <span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span></p><p class="line867"><span class="anchor" id="A12"></span> <span class="anchor" id="line-158"></span>4.2.1. 技術的な考慮  Technical considerations <span class="anchor" id="line-159"></span><span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span></p><pre><span class="anchor" id="line-1-9"></span>The data that describes a zone has four major parts:</pre><span class="anchor" id="line-162"></span><p class="line874">ゾーンを記述するデータは大きく四つに分けられる： <span class="anchor" id="line-163"></span><span class="anchor" id="line-164"></span><span class="anchor" id="line-165"></span></p><pre><span class="anchor" id="line-1-10"></span>   - Authoritative data for all nodes within the zone.</pre><span class="anchor" id="line-166"></span><ul><li style="list-style-type:none">- ゾーン内の全ノードの権威あるデータ。 <span class="anchor" id="line-167"></span></li></ul><p class="line867"><span class="anchor" id="line-168"></span><span class="anchor" id="line-169"></span><span class="anchor" id="line-170"></span></p><pre><span class="anchor" id="line-1-11"></span>   - Data that defines the top node of the zone (can be thought of
<span class="anchor" id="line-2-9"></span>     as part of the authoritative data).</pre><span class="anchor" id="line-171"></span><ul><li style="list-style-type:none">- ゾーンの最上位ノードを定義するデータ <span class="anchor" id="line-172"></span>（権威あるデータの一部であると考えられる）。 <span class="anchor" id="line-173"></span></li></ul><p class="line867"><span class="anchor" id="line-174"></span><span class="anchor" id="line-175"></span><span class="anchor" id="line-176"></span></p><pre><span class="anchor" id="line-1-12"></span>   - Data that describes delegated subzones, i.e., cuts around the
<span class="anchor" id="line-2-10"></span>     bottom of the zone.</pre><span class="anchor" id="line-177"></span><ul><li style="list-style-type:none">- 委譲されたサブゾーンを記述するデータ、 <span class="anchor" id="line-178"></span><ul><li style="list-style-type:none">すなわち、ゾーンの最下部での切断。 <span class="anchor" id="line-179"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-180"></span><span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span></p><pre><span class="anchor" id="line-1-13"></span>   - Data that allows access to name servers for subzones
<span class="anchor" id="line-2-11"></span>     (sometimes called ';glue'; data).</pre><span class="anchor" id="line-183"></span><ul><li style="list-style-type:none">- サブゾーンのネームサーバへのアクセスを可能にするデータ <span class="anchor" id="line-184"></span>（しばしば「グルー(のり)」と呼ばれる）。 <span class="anchor" id="line-185"></span></li></ul><p class="line867"><span class="anchor" id="line-186"></span><span class="anchor" id="line-187"></span><span class="anchor" id="line-188"></span><span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span><span class="anchor" id="line-191"></span></p><pre><span class="anchor" id="line-1-14"></span>All of this data is expressed in the form of RRs, so a zone can be
<span class="anchor" id="line-2-12"></span>completely described in terms of a set of RRs.  Whole zones can be
<span class="anchor" id="line-3-8"></span>transferred between name servers by transferring the RRs, either carried
<span class="anchor" id="line-4-8"></span>in a series of messages or by FTPing a master file which is a textual
<span class="anchor" id="line-5-6"></span>representation.</pre><span class="anchor" id="line-192"></span><p class="line874">ここのすべてのデータは RR という形で表現される。 <span class="anchor" id="line-193"></span>そのためゾーンは RRs の集合を使って完全に記述できる。 <span class="anchor" id="line-194"></span>ネームサーバ間のゾーン全体を転送の転送は <span class="anchor" id="line-195"></span>RRs の転送によって、あるいは <span class="anchor" id="line-196"></span>メッセージ列としての転送、 <span class="anchor" id="line-197"></span>もしくはテキスト表現であるマスターファイルの FTP などで可能である。 <span class="anchor" id="line-198"></span><span class="anchor" id="line-199"></span><span class="anchor" id="line-200"></span><span class="anchor" id="line-201"></span><span class="anchor" id="line-202"></span></p><pre><span class="anchor" id="line-1-15"></span>The authoritative data for a zone is simply all of the RRs attached to
<span class="anchor" id="line-2-13"></span>all of the nodes from the top node of the zone down to leaf nodes or
<span class="anchor" id="line-3-9"></span>nodes above cuts around the bottom edge of the zone.</pre><span class="anchor" id="line-203"></span><p class="line874">ゾーンの権威あるデータとは <span class="anchor" id="line-204"></span>ゾーンのトップノードからリーフかゾーン下端の切断のすぐ上のノードまでの <span class="anchor" id="line-205"></span>全てのノードに付属する全ての RRs のことにすぎない。 <span class="anchor" id="line-206"></span><span class="anchor" id="line-207"></span><span class="anchor" id="line-208"></span><span class="anchor" id="line-209"></span><span class="anchor" id="line-210"></span><span class="anchor" id="line-211"></span><span class="anchor" id="line-212"></span></p><pre><span class="anchor" id="line-1-16"></span>Though logically part of the authoritative data, the RRs that describe
<span class="anchor" id="line-2-14"></span>the top node of the zone are especially important to the zone's
<span class="anchor" id="line-3-10"></span>management.  These RRs are of two types: name server RRs that list, one
<span class="anchor" id="line-4-9"></span>per RR, all of the servers for the zone, and a single SOA RR that
<span class="anchor" id="line-5-7"></span>describes zone management parameters.</pre><span class="anchor" id="line-213"></span><p class="line874">論理的に言えば、権威あるデータの一部ではあるが、 <span class="anchor" id="line-214"></span>ゾーンの最上位ノードを記述する RRs はゾーンの管理にとって特に重要である。 <span class="anchor" id="line-215"></span><span class="anchor" id="line-216"></span></p><p class="line874">この資源レコードとは以下の二つのタイプである: <span class="anchor" id="line-217"></span>ネームサーバ RRs (ゾーンのすべてのネームサーバを数えあげたもので、 <span class="anchor" id="line-218"></span>ゾーンネームサーバ毎にひとつずつ)と、 <span class="anchor" id="line-219"></span>ゾーン管理のパラメタを記述するSOA RR ひとつとである。 <span class="anchor" id="line-220"></span><span class="anchor" id="line-221"></span><span class="anchor" id="line-222"></span><span class="anchor" id="line-223"></span><span class="anchor" id="line-224"></span><span class="anchor" id="line-225"></span><span class="anchor" id="line-226"></span><span class="anchor" id="line-227"></span><span class="anchor" id="line-228"></span><span class="anchor" id="line-229"></span><span class="anchor" id="line-230"></span></p><pre><span class="anchor" id="line-1-17"></span>The RRs that describe cuts around the bottom of the zone are NS RRs that
<span class="anchor" id="line-2-15"></span>name the servers for the subzones.  Since the cuts are between nodes,
<span class="anchor" id="line-3-11"></span>these RRs are NOT part of the authoritative data of the zone, and should
<span class="anchor" id="line-4-10"></span>be exactly the same as the corresponding RRs in the top node of the
<span class="anchor" id="line-5-8"></span>subzone.  Since name servers are always associated with zone boundaries,
<span class="anchor" id="line-6-5"></span>NS RRs are only found at nodes which are the top node of some zone.  In
<span class="anchor" id="line-7-4"></span>the data that makes up a zone, NS RRs are found at the top node of the
<span class="anchor" id="line-8-3"></span>zone (and are authoritative) and at cuts around the bottom of the zone
<span class="anchor" id="line-9-1"></span>(where they are not authoritative), but never in between.</pre><span class="anchor" id="line-231"></span><p class="line874">ゾーンの下部にあって、ゾーンカットを記述している RRs は <span class="anchor" id="line-232"></span>サブゾーンのネームサーバ名を指す NS RRs である。 <span class="anchor" id="line-233"></span>切断はノード間でおきるので、 <span class="anchor" id="line-234"></span>これらの RRs は当該ゾーンの権威あるデータの一部では「ない」。 <span class="anchor" id="line-235"></span><span class="anchor" id="line-236"></span></p><p class="line874">そして、RRs はサブゾーンの最上位にある対応する RRs と <span class="anchor" id="line-237"></span>一致させなければならない。 <span class="anchor" id="line-238"></span>ネームサーバというもの常にゾーン境界線と結び付いてるので、 <span class="anchor" id="line-239"></span>NS RRs はゾーンの最上位ノードにだけつけるべきものである。 <span class="anchor" id="line-240"></span><span class="anchor" id="line-241"></span></p><p class="line874">ゾーンを構成しているデータ中では、NS RRs は <span class="anchor" id="line-242"></span>ゾーンの最上位ノードについている（権威がある）か、 <span class="anchor" id="line-243"></span>ゾーンの底部のカットにある(権威はない)かであり、 <span class="anchor" id="line-244"></span>中間にはあらわれない。 <span class="anchor" id="line-245"></span><span class="anchor" id="line-246"></span><span class="anchor" id="line-247"></span><span class="anchor" id="line-248"></span><span class="anchor" id="line-249"></span><span class="anchor" id="line-250"></span><span class="anchor" id="line-251"></span><span class="anchor" id="line-252"></span><span class="anchor" id="line-253"></span><span class="anchor" id="line-254"></span><span class="anchor" id="line-255"></span><span class="anchor" id="line-256"></span><span class="anchor" id="line-257"></span><span class="anchor" id="line-258"></span><span class="anchor" id="line-259"></span><span class="anchor" id="line-260"></span></p><pre><span class="anchor" id="line-1-18"></span>One of the goals of the zone structure is that any zone have all the
<span class="anchor" id="line-2-16"></span>data required to set up communications with the name servers for any
<span class="anchor" id="line-3-12"></span>subzones.  That is, parent zones have all the information needed to
<span class="anchor" id="line-4-11"></span>access servers for their children zones.  The NS RRs that name the
<span class="anchor" id="line-5-9"></span>servers for subzones are often not enough for this task since they name
<span class="anchor" id="line-6-6"></span>the servers, but do not give their addresses.  In particular, if the
<span class="anchor" id="line-7-5"></span>name of the name server is itself in the subzone, we could be faced with
<span class="anchor" id="line-8-4"></span>the situation where the NS RRs tell us that in order to learn a name
<span class="anchor" id="line-9-2"></span>server's address, we should contact the server using the address we wish
<span class="anchor" id="line-10"></span>to learn.  To fix this problem, a zone contains ';glue'; RRs
<span class="anchor" id="line-11"></span>which are not
<span class="anchor" id="line-12"></span>part of the authoritative data, and are address RRs for the servers.
<span class="anchor" id="line-13"></span>These RRs are only necessary if the name server's name is ';below'; the
<span class="anchor" id="line-14"></span>cut, and are only used as part of a referral response.</pre><span class="anchor" id="line-261"></span><p class="line874">ゾーン構造の目標のひとつとして、 <span class="anchor" id="line-262"></span>どのゾーンもそのサブゾーンのネームサーバとの交信に必要なすべてデータを <span class="anchor" id="line-263"></span>持つということがある。 <span class="anchor" id="line-264"></span>すなわち、親ゾーンはその子ゾーンのサーバにアクセスするのに <span class="anchor" id="line-265"></span>必要な全ての情報を持つことである。 <span class="anchor" id="line-266"></span>サブゾーンのサーバの名前を指す NS RRs はこの用途には不十分である。 <span class="anchor" id="line-267"></span>それはサーバの名前は分ってもアドレスを示さないからである。 <span class="anchor" id="line-268"></span>とりわけ、ネームサーバの名前がサブゾーンのものである場合には <span class="anchor" id="line-269"></span>「ネームサーバのアドレスを知るために、 <span class="anchor" id="line-270"></span>知りたいところのアドレスを使ってそのネームサーバにアクセスしなければならない」 <span class="anchor" id="line-271"></span>ということを NS RRs が示すという状況になってしまう。 <span class="anchor" id="line-272"></span>この問題を解決するため、ゾーンは グルー RRs を持つ。 <span class="anchor" id="line-273"></span>(グルーは権威あるデータの一部ではなくて、ネームサーバのアドレス RRs である。) <span class="anchor" id="line-274"></span>これらの RRs はネームサーバの名前がカットより「下」にある時にだけ <span class="anchor" id="line-275"></span>必要であり、参照返答(referral)の一部としてだけ用いられる。 <span class="anchor" id="line-276"></span><span class="anchor" id="line-277"></span></p><p class="line867"><span class="anchor" id="A13"></span> <span class="anchor" id="line-278"></span>4.2.2. 管理上の考慮 Administrative considerations <span class="anchor" id="line-279"></span><span class="anchor" id="line-280"></span><span class="anchor" id="line-281"></span><span class="anchor" id="line-282"></span><span class="anchor" id="line-283"></span><span class="anchor" id="line-284"></span><span class="anchor" id="line-285"></span><span class="anchor" id="line-286"></span><span class="anchor" id="line-287"></span><span class="anchor" id="line-288"></span><span class="anchor" id="line-289"></span><span class="anchor" id="line-290"></span></p><pre><span class="anchor" id="line-1-19"></span>When some organization wants to control its own domain, the first step
<span class="anchor" id="line-2-17"></span>is to identify the proper parent zone, and get the parent zone's owners
<span class="anchor" id="line-3-13"></span>to agree to the delegation of control.  While there are no particular
<span class="anchor" id="line-4-12"></span>technical constraints dealing with where in the tree this can be done,
<span class="anchor" id="line-5-10"></span>there are some administrative groupings discussed in [RFC-1032] which
<span class="anchor" id="line-6-7"></span>deal with top level organization, and middle level zones are free to
<span class="anchor" id="line-7-6"></span>create their own rules.  For example, one university might choose to use
<span class="anchor" id="line-8-5"></span>a single zone, while another might choose to organize by subzones
<span class="anchor" id="line-9-3"></span>dedicated to individual departments or schools.  [RFC-1033] catalogs
<span class="anchor" id="line-10-1"></span>available DNS software an discusses administration procedures.</pre><span class="anchor" id="line-291"></span><p class="line874">組織が自身のドメインを管理しようとするときの最初の一歩は <span class="anchor" id="line-292"></span>正しく親ゾーンを知り、親ゾーンの所有者に管理を委譲してもらうよう <span class="anchor" id="line-293"></span>同意をとることである。 <span class="anchor" id="line-294"></span>ドメイン木のどこで委譲してよいかに関しては特別な技術的制約はないが、 <span class="anchor" id="line-295"></span>最上位組織を扱う[RFC-1032]で論じられている管理グループ分けは存在している。 <span class="anchor" id="line-296"></span>さらに、中間レベルのゾーンは自身の規則を自由に作ってよい。 <span class="anchor" id="line-297"></span>例えば、ある大学はゾーンをひとつだけ使うことを選ぶかもしれないし、 <span class="anchor" id="line-298"></span>また別の大学は部門や各学校にサブゾーン専用に設けるやりかたを選ぶ <span class="anchor" id="line-299"></span>かもしれない。 <span class="anchor" id="line-300"></span>[RFC-1033]には利用可能なDNS ソフトウェアの一覧があり、 <span class="anchor" id="line-301"></span>管理手順を論じている。 <span class="anchor" id="line-302"></span><span class="anchor" id="line-303"></span><span class="anchor" id="line-304"></span><span class="anchor" id="line-305"></span><span class="anchor" id="line-306"></span><span class="anchor" id="line-307"></span><span class="anchor" id="line-308"></span><span class="anchor" id="line-309"></span><span class="anchor" id="line-310"></span><span class="anchor" id="line-311"></span><span class="anchor" id="line-312"></span><span class="anchor" id="line-313"></span></p><pre><span class="anchor" id="line-1-20"></span>Once the proper name for the new subzone is selected, the new owners
<span class="anchor" id="line-2-18"></span>should be required to demonstrate redundant name server support.  Note
<span class="anchor" id="line-3-14"></span>that there is no requirement that the servers for a zone reside in a
<span class="anchor" id="line-4-13"></span>host which has a name in that domain.  In many cases, a zone will be
<span class="anchor" id="line-5-11"></span>more accessible to the internet at large if its servers are widely
<span class="anchor" id="line-6-8"></span>distributed rather than being within the physical facilities controlled
<span class="anchor" id="line-7-7"></span>by the same organization that manages the zone.  For example, in the
<span class="anchor" id="line-8-6"></span>current DNS, one of the name servers for the United Kingdom, or UK
<span class="anchor" id="line-9-4"></span>domain, is found in the US.  This allows US hosts to get UK data without
<span class="anchor" id="line-10-2"></span>using limited transatlantic bandwidth.</pre><span class="anchor" id="line-314"></span><p class="line874">新しいサブゾーンにふさわしい名前が選ばれたら、 <span class="anchor" id="line-315"></span>新しい(ゾーン)所有者は複数のネームサーバを用意できることを <span class="anchor" id="line-316"></span>示すべきである。 <span class="anchor" id="line-317"></span><span class="anchor" id="line-318"></span></p><p class="line874">ゾーンのためのサーバがそのドメインの名前を持ったホスト上にある <span class="anchor" id="line-319"></span>必要はないということに注意せよ。 <span class="anchor" id="line-320"></span>多くの場合、ゾーンを維持する組織が管理する施設内にサーバがあるより、 <span class="anchor" id="line-321"></span>広く分散されている方がインターネット一般からアクセスしやすいだろう。 <span class="anchor" id="line-322"></span>例えば、現在の DNSではイギリス、つまり UK ドメインのための <span class="anchor" id="line-323"></span>ネームサーバのひとつは US 内にある。 <span class="anchor" id="line-324"></span>これにより、US のホストは <span class="anchor" id="line-325"></span>帯域の限定された太西洋横断回線を使わなくとも、 <span class="anchor" id="line-326"></span>UK のデータを得られる。 <span class="anchor" id="line-327"></span><span class="anchor" id="line-328"></span><span class="anchor" id="line-329"></span><span class="anchor" id="line-330"></span><span class="anchor" id="line-331"></span><span class="anchor" id="line-332"></span></p><pre><span class="anchor" id="line-1-21"></span>As the last installation step, the delegation NS RRs and glue RRs
<span class="anchor" id="line-2-19"></span>necessary to make the delegation effective should be added to the parent
<span class="anchor" id="line-3-15"></span>zone.  The administrators of both zones should insure that the NS and
<span class="anchor" id="line-4-14"></span>glue RRs which mark both sides of the cut are consistent and remain so.</pre><span class="anchor" id="line-333"></span><p class="line874">インストールの最後のステップとして、親ゾーンには <span class="anchor" id="line-334"></span>委譲が効果をもつのに必要な委譲のための NS RRs と グルー RRs を <span class="anchor" id="line-335"></span>加えなければならない。 <span class="anchor" id="line-336"></span>両方のゾーンの管理者は <span class="anchor" id="line-337"></span>カットの両面を表わす NS と グルー RRs が一致していて、 <span class="anchor" id="line-338"></span>いつまでもそうあり続けることを保証しなければならない。 <span class="anchor" id="line-339"></span><span class="anchor" id="line-340"></span></p><p class="line867"><span class="anchor" id="A14"></span> <span class="anchor" id="line-341"></span>
</p><h2 id="A4.3._.2BMM0w.2FDDgMLUw.2FDDQMG5RhZDoUtVPXA_Name_server_internals">4.3. ネームサーバの内部動作 Name server internals</h2>
<span class="anchor" id="line-342"></span><p class="line867"><span class="anchor" id="A15"></span> <span class="anchor" id="line-343"></span>4.3.1. 問合せと返答 Queries and responses <span class="anchor" id="line-344"></span><span class="anchor" id="line-345"></span><span class="anchor" id="line-346"></span><span class="anchor" id="line-347"></span><span class="anchor" id="line-348"></span><span class="anchor" id="line-349"></span><span class="anchor" id="line-350"></span></p><pre><span class="anchor" id="line-1-22"></span>The principal activity of name servers is to answer standard queries.
<span class="anchor" id="line-2-20"></span>Both the query and its response are carried in a standard message format
<span class="anchor" id="line-3-16"></span>which is described in [RFC-1035].  The query contains a QTYPE, QCLASS,
<span class="anchor" id="line-4-15"></span>and QNAME, which describe the types and classes of desired information
<span class="anchor" id="line-5-12"></span>and the name of interest.</pre><span class="anchor" id="line-351"></span><p class="line874">ネームサーバの主たる動作は標準問合せに答える事である。 <span class="anchor" id="line-352"></span>問合せとその返答の両者は[RFC-1035]に記述された標準メッセージ形式に従う。 <span class="anchor" id="line-353"></span>質問はQTYPE、QCLASS、QNAMEひとつずつを含み、 <span class="anchor" id="line-354"></span>これらは求める情報のタイプ、クラスと興味がある名前を記述する。 <span class="anchor" id="line-355"></span><span class="anchor" id="line-356"></span><span class="anchor" id="line-357"></span><span class="anchor" id="line-358"></span></p><pre><span class="anchor" id="line-1-23"></span>The way that the name server answers the query depends upon whether it
<span class="anchor" id="line-2-21"></span>is operating in recursive mode or not:</pre><span class="anchor" id="line-359"></span><p class="line874">ネームサーバが問合せに答える方法は <span class="anchor" id="line-360"></span>再帰モードで動作しているかどうかによる: <span class="anchor" id="line-361"></span><span class="anchor" id="line-362"></span><span class="anchor" id="line-363"></span><span class="anchor" id="line-364"></span><span class="anchor" id="line-365"></span><span class="anchor" id="line-366"></span><span class="anchor" id="line-367"></span></p><pre><span class="anchor" id="line-1-24"></span>   - The simplest mode for the server is non-recursive, since it
<span class="anchor" id="line-2-22"></span>     can answer queries using only local information: the response
<span class="anchor" id="line-3-17"></span>     contains an error, the answer, or a referral to some other
<span class="anchor" id="line-4-16"></span>     server ';closer'; to the answer.  All name servers must
<span class="anchor" id="line-5-13"></span>     implement non-recursive queries.</pre><span class="anchor" id="line-368"></span><ul><li style="list-style-type:none">- サーバとして一番単純なのは非再帰モードである。 ローカル情報だけを使って問合せに答えることができるためだ： <span class="anchor" id="line-369"></span><ul><li style="list-style-type:none">返答にはエラーか、答か、「より近い」サーバへの参照かの三種がある。 <span class="anchor" id="line-370"></span>どのネームサーバも非再帰問合せはかならず実装しなければならない。 <span class="anchor" id="line-371"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-372"></span><span class="anchor" id="line-373"></span><span class="anchor" id="line-374"></span><span class="anchor" id="line-375"></span><span class="anchor" id="line-376"></span><span class="anchor" id="line-377"></span><span class="anchor" id="line-378"></span></p><pre><span class="anchor" id="line-1-25"></span>   - The simplest mode for the client is recursive, since in this
<span class="anchor" id="line-2-23"></span>     mode the name server acts in the role of a resolver and
<span class="anchor" id="line-3-18"></span>     returns either an error or the answer, but never referrals.
<span class="anchor" id="line-4-17"></span>     This service is optional in a name server, and the name server
<span class="anchor" id="line-5-14"></span>     may also choose to restrict the clients which can use
<span class="anchor" id="line-6-9"></span>     recursive mode.</pre><span class="anchor" id="line-379"></span><ul><li style="list-style-type:none">- クライアントから見たとき、最も単純なモードは再帰モードである。 <span class="anchor" id="line-380"></span><ul><li style="list-style-type:none">このモードではネームサーバがリゾルバの役割をはたしてくれるから。 <span class="anchor" id="line-381"></span>それはエラーか答かを返す。けして参照は返さない。 <span class="anchor" id="line-382"></span>ネームサーバでのこのサービスは実装任意である。 <span class="anchor" id="line-383"></span>また、ネームサーバは再帰モードを利用できるクライアントを制限してよい。 <span class="anchor" id="line-384"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-385"></span><span class="anchor" id="line-386"></span></p><pre><span class="anchor" id="line-1-26"></span>Recursive service is helpful in several situations:</pre><span class="anchor" id="line-387"></span><p class="line874">再帰サービスが役立ついくつかの状況は： <span class="anchor" id="line-388"></span><span class="anchor" id="line-389"></span><span class="anchor" id="line-390"></span><span class="anchor" id="line-391"></span></p><pre><span class="anchor" id="line-1-27"></span>   - a relatively simple requester that lacks the ability to use
<span class="anchor" id="line-2-24"></span>     anything other than a direct answer to the question.</pre><span class="anchor" id="line-392"></span><ul><li style="list-style-type:none">- 質問への直接の答以外を扱う能力に欠ける単純な要求者 <span class="anchor" id="line-393"></span></li></ul><p class="line867"><span class="anchor" id="line-394"></span><span class="anchor" id="line-395"></span><span class="anchor" id="line-396"></span></p><pre><span class="anchor" id="line-1-28"></span>   - a request that needs to cross protocol or other boundaries and
<span class="anchor" id="line-2-25"></span>     can be sent to a server which can act as intermediary.</pre><span class="anchor" id="line-397"></span><ul><li style="list-style-type:none">- プロトコルやその他の境界を越える必要があり、 <span class="anchor" id="line-398"></span><ul><li style="list-style-type:none">媒介できる出来るサーバへ送って構わないリクエスト <span class="anchor" id="line-399"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-400"></span><span class="anchor" id="line-401"></span><span class="anchor" id="line-402"></span></p><pre><span class="anchor" id="line-1-29"></span>   - a network where we want to concentrate the cache rather than
<span class="anchor" id="line-2-26"></span>     having a separate cache for each client.</pre><span class="anchor" id="line-403"></span><ul><li style="list-style-type:none">- クライアント毎にキャッシュを持たせないで、集中キャッシュを <span class="anchor" id="line-404"></span><ul><li style="list-style-type:none">使いたいネットワーク。 <span class="anchor" id="line-405"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-406"></span><span class="anchor" id="line-407"></span><span class="anchor" id="line-408"></span><span class="anchor" id="line-409"></span></p><pre><span class="anchor" id="line-1-30"></span>Non-recursive service is appropriate if the requester is capable of
<span class="anchor" id="line-2-27"></span>pursuing referrals and interested in information which will aid future
<span class="anchor" id="line-3-19"></span>requests.</pre><span class="anchor" id="line-410"></span><p class="line874">非再帰サービスが適切なのは参照(referral) を利用することができて、 <span class="anchor" id="line-411"></span>将来のリクエストの助けになる情報に興味がある要求者の場合である。 <span class="anchor" id="line-412"></span><span class="anchor" id="line-413"></span></p><p class="line867"><span class="anchor" id="line-414"></span><span class="anchor" id="line-415"></span><span class="anchor" id="line-416"></span><span class="anchor" id="line-417"></span></p><pre><span class="anchor" id="line-1-31"></span>The use of recursive mode is limited to cases where both the client and
<span class="anchor" id="line-2-28"></span>the name server agree to its use.  The agreement is negotiated through
<span class="anchor" id="line-3-20"></span>the use of two bits in query and response messages:</pre><span class="anchor" id="line-418"></span><p class="line874">再帰モードを使用するのは <span class="anchor" id="line-419"></span>クライアントとネームサーバの両方が使用に同意することが条件になる。 <span class="anchor" id="line-420"></span>合意の交渉には問合せと返答メッセージ中の 2ビットが使用される。 <span class="anchor" id="line-421"></span><span class="anchor" id="line-422"></span><span class="anchor" id="line-423"></span><span class="anchor" id="line-424"></span><span class="anchor" id="line-425"></span><span class="anchor" id="line-426"></span><span class="anchor" id="line-427"></span></p><pre><span class="anchor" id="line-1-32"></span>   - The recursion available, or RA bit, is set or cleared by a
<span class="anchor" id="line-2-29"></span>     name server in all responses.  The bit is true if the name
<span class="anchor" id="line-3-21"></span>     server is willing to provide recursive service for the client,
<span class="anchor" id="line-4-18"></span>     regardless of whether the client requested recursive service.
<span class="anchor" id="line-5-15"></span>     That is, RA signals availability rather than use.</pre><span class="anchor" id="line-428"></span><ul><li style="list-style-type:none">- 再帰可能（RAビット）はネームサーバの全ての返答で設定/クリアされる。 <span class="anchor" id="line-429"></span><ul><li style="list-style-type:none">このビットはクライアントが再帰サービスを求めたかどうかに関わらず、 <span class="anchor" id="line-430"></span>サーバがサービスを提供できるなら 1 である。つまり、RA は使うと <span class="anchor" id="line-431"></span>いうより使えることを示す。 <span class="anchor" id="line-432"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-433"></span><span class="anchor" id="line-434"></span><span class="anchor" id="line-435"></span><span class="anchor" id="line-436"></span><span class="anchor" id="line-437"></span><span class="anchor" id="line-438"></span><span class="anchor" id="line-439"></span><span class="anchor" id="line-440"></span></p><pre><span class="anchor" id="line-1-33"></span>   - Queries contain a bit called recursion desired or RD.  This
<span class="anchor" id="line-2-30"></span>     bit specifies specifies whether the requester wants recursive
<span class="anchor" id="line-3-22"></span>     service for this query.  Clients may request recursive service
<span class="anchor" id="line-4-19"></span>     from any name server, though they should depend upon receiving
<span class="anchor" id="line-5-16"></span>     it only from servers which have previously sent an RA, or
<span class="anchor" id="line-6-10"></span>     servers which have agreed to provide service through private
<span class="anchor" id="line-7-8"></span>     agreement or some other means outside of the DNS protocol.</pre><span class="anchor" id="line-441"></span><ul><li style="list-style-type:none">- 問合せは再帰要望(RD)と呼ばれるビットを含む。 <span class="anchor" id="line-442"></span><ul><li style="list-style-type:none">このビットは問合せが再帰サービスを望んでいるかを示す。 <span class="anchor" id="line-443"></span>クライアントはサーバに再帰的サービスを求めるのはよいが、 <span class="anchor" id="line-444"></span>過去に RAが設定された返答をもらったサーバか <span class="anchor" id="line-445"></span>別途 DNS プロトコル外の何らかの方法で合意したサーバだけから <span class="anchor" id="line-446"></span>再帰サービスの返事を受け取れると思うべきである。 <span class="anchor" id="line-447"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-448"></span><span class="anchor" id="line-449"></span><span class="anchor" id="line-450"></span><span class="anchor" id="line-451"></span><span class="anchor" id="line-452"></span><span class="anchor" id="line-453"></span><span class="anchor" id="line-454"></span></p><pre><span class="anchor" id="line-1-34"></span>The recursive mode occurs when a query with RD set arrives at a server
<span class="anchor" id="line-2-31"></span>which is willing to provide recursive service; the client can verify
<span class="anchor" id="line-3-23"></span>that recursive mode was used by checking that both RA and RD are set in
<span class="anchor" id="line-4-20"></span>the reply.  Note that the name server should never perform recursive
<span class="anchor" id="line-5-17"></span>service unless asked via RD, since this interferes with trouble shooting
<span class="anchor" id="line-6-11"></span>of name servers and their databases.</pre><span class="anchor" id="line-455"></span><p class="line874">RD が設定された問合せがサーバに届き、 <span class="anchor" id="line-456"></span>サーバが再帰サービスを提供している場合に再帰モードが有効になる; <span class="anchor" id="line-457"></span>クライアントは返答で RAとRDの両方のビットが設定されていることを調べて、 <span class="anchor" id="line-458"></span>再帰モードが使われたことを確認できる。 <span class="anchor" id="line-459"></span>ネームサーバは RD により要請がない場合には再帰サービスを実行すべきではない <span class="anchor" id="line-460"></span>ことに注意せよ。 <span class="anchor" id="line-461"></span>再帰はネームサーバやそのデータベースの障害検出の邪魔になるからである。 <span class="anchor" id="line-462"></span><span class="anchor" id="line-463"></span><span class="anchor" id="line-464"></span><span class="anchor" id="line-465"></span></p><pre><span class="anchor" id="line-1-35"></span>If recursive service is requested and available, the recursive response
<span class="anchor" id="line-2-32"></span>to a query will be one of the following:</pre><span class="anchor" id="line-466"></span><p class="line874">再帰サービスが要請され、利用できる場合、再帰の返答は以下ようなものだ： <span class="anchor" id="line-467"></span><span class="anchor" id="line-468"></span><span class="anchor" id="line-469"></span><span class="anchor" id="line-470"></span></p><pre><span class="anchor" id="line-1-36"></span>   - The answer to the query, possibly preface by one or more CNAME
<span class="anchor" id="line-2-33"></span>     RRs that specify aliases encountered on the way to an answer.</pre><span class="anchor" id="line-471"></span><ul><li style="list-style-type:none">- 問合せへの答、途中で遭遇したCNAME RRsが前についている <span class="anchor" id="line-472"></span><ul><li style="list-style-type:none">可能性がある。 <span class="anchor" id="line-473"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-474"></span><span class="anchor" id="line-475"></span><span class="anchor" id="line-476"></span><span class="anchor" id="line-477"></span></p><pre><span class="anchor" id="line-1-37"></span>   - A name error indicating that the name does not exist.  This
<span class="anchor" id="line-2-34"></span>     may include CNAME RRs that indicate that the original query
<span class="anchor" id="line-3-24"></span>     name was an alias for a name which does not exist.</pre><span class="anchor" id="line-478"></span><ul><li style="list-style-type:none">- 名前が存在しないことを示す名前エラー。これは元の問合せ名が <span class="anchor" id="line-479"></span><ul><li style="list-style-type:none">CNAME RR であって、存在しない名前の別名だった場合もありうる。 <span class="anchor" id="line-480"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-481"></span><span class="anchor" id="line-482"></span></p><pre><span class="anchor" id="line-1-38"></span>   - A temporary error indication.</pre><span class="anchor" id="line-483"></span><ul><li style="list-style-type:none">- 一時的エラー <span class="anchor" id="line-484"></span></li></ul><p class="line867"><span class="anchor" id="line-485"></span><span class="anchor" id="line-486"></span><span class="anchor" id="line-487"></span></p><pre><span class="anchor" id="line-1-39"></span>If recursive service is not requested or is not available, the non-
<span class="anchor" id="line-2-35"></span>recursive response will be one of the following:</pre><span class="anchor" id="line-488"></span><p class="line874">再帰サービスが要請されていないか、利用可能でない場合、非再帰の応答は <span class="anchor" id="line-489"></span>以下のどれかになる: <span class="anchor" id="line-490"></span><span class="anchor" id="line-491"></span><span class="anchor" id="line-492"></span><span class="anchor" id="line-493"></span></p><pre><span class="anchor" id="line-1-40"></span>   - An authoritative name error indicating that the name does not
<span class="anchor" id="line-2-36"></span>     exist.</pre><span class="anchor" id="line-494"></span><ul><li style="list-style-type:none">- 名前が存在しないことを示す権威ある名前エラー <span class="anchor" id="line-495"></span></li></ul><p class="line867"><span class="anchor" id="line-496"></span><span class="anchor" id="line-497"></span></p><pre><span class="anchor" id="line-1-41"></span>   - A temporary error indication.</pre><span class="anchor" id="line-498"></span><ul><li style="list-style-type:none">- 一時的エラー <span class="anchor" id="line-499"></span></li></ul><p class="line867"><span class="anchor" id="line-500"></span><span class="anchor" id="line-501"></span></p><pre><span class="anchor" id="line-1-42"></span>   - Some combination of:</pre><span class="anchor" id="line-502"></span><ul><li style="list-style-type:none">- 以下のいずれかの組み合わせ：。 <span class="anchor" id="line-503"></span></li></ul><p class="line867"><span class="anchor" id="line-504"></span><span class="anchor" id="line-505"></span><span class="anchor" id="line-506"></span></p><pre><span class="anchor" id="line-1-43"></span>     RRs that answer the question, together with an indication
<span class="anchor" id="line-2-37"></span>     whether the data comes from a zone or is cached.</pre><span class="anchor" id="line-507"></span><ul><li style="list-style-type:none">答となる RRsと そのデータがゾーンからのものかキャッシュからのものかの区別 <span class="anchor" id="line-508"></span></li></ul><p class="line867"><span class="anchor" id="line-509"></span><span class="anchor" id="line-510"></span><span class="anchor" id="line-511"></span></p><pre><span class="anchor" id="line-1-44"></span>     A referral to name servers which have zones which are closer
<span class="anchor" id="line-2-38"></span>     ancestors to the name than the server sending the reply.</pre><span class="anchor" id="line-512"></span><ul><li style="list-style-type:none">求める名前により近い祖先のゾーンを持つネームサーバへの参照。 <span class="anchor" id="line-513"></span></li></ul><p class="line867"><span class="anchor" id="line-514"></span><span class="anchor" id="line-515"></span><span class="anchor" id="line-516"></span></p><pre><span class="anchor" id="line-1-45"></span>   - RRs that the name server thinks will prove useful to the
<span class="anchor" id="line-2-39"></span>     requester.</pre><span class="anchor" id="line-517"></span><ul><li style="list-style-type:none">- 問合せ者に有用であろうとネームサーバが考えた RRs。 <span class="anchor" id="line-518"></span><span class="anchor" id="line-519"></span></li></ul><p class="line867"><span class="anchor" id="A16"></span> <span class="anchor" id="line-520"></span>4.3.2. アルゴリズム Algorithm <span class="anchor" id="line-521"></span><span class="anchor" id="line-522"></span><span class="anchor" id="line-523"></span><span class="anchor" id="line-524"></span><span class="anchor" id="line-525"></span><span class="anchor" id="line-526"></span></p><pre><span class="anchor" id="line-1-46"></span>The actual algorithm used by the name server will depend on the local OS
<span class="anchor" id="line-2-40"></span>and data structures used to store RRs.  The following algorithm assumes
<span class="anchor" id="line-3-25"></span>that the RRs are organized in several tree structures, one for each
<span class="anchor" id="line-4-21"></span>zone, and another for the cache:</pre><span class="anchor" id="line-527"></span><p class="line874">ネームサーバが実際に使うアルゴリズムは <span class="anchor" id="line-528"></span>ローカルOSと資源レコードを保持するデータ構造に依存するだろう。 <span class="anchor" id="line-529"></span>以下のアルゴリズムでは RRs は複数の木構造、 <span class="anchor" id="line-530"></span>各ゾーン毎のものと、キャッシュに対応したもの、 <span class="anchor" id="line-531"></span>として構成されていることを仮定している: <span class="anchor" id="line-532"></span><span class="anchor" id="line-533"></span><span class="anchor" id="line-534"></span><span class="anchor" id="line-535"></span><span class="anchor" id="line-536"></span><span class="anchor" id="line-537"></span><span class="anchor" id="line-538"></span></p><pre><span class="anchor" id="line-1-47"></span>   1. Set or clear the value of recursion available in the response
<span class="anchor" id="line-2-41"></span>      depending on whether the name server is willing to provide
<span class="anchor" id="line-3-26"></span>      recursive service.  If recursive service is available and
<span class="anchor" id="line-4-22"></span>      requested via the RD bit in the query, go to step 5,
<span class="anchor" id="line-5-18"></span>      otherwise step 2.</pre><span class="anchor" id="line-539"></span><ul><li style="list-style-type:none">再帰サービスを提供するかどうかによって、返答の再帰可能値を設定する。 <span class="anchor" id="line-540"></span>再帰サービスが可能であって、問合せの RD ビットにより再帰が求められているなら、 <span class="anchor" id="line-541"></span>ステップ 5 へ行く。そうでなければステップ 2 へ。 <span class="anchor" id="line-542"></span></li></ul><p class="line867"><span class="anchor" id="line-543"></span><span class="anchor" id="line-544"></span><span class="anchor" id="line-545"></span><span class="anchor" id="line-546"></span></p><pre><span class="anchor" id="line-1-48"></span>   2. Search the available zones for the zone which is the nearest
<span class="anchor" id="line-2-42"></span>      ancestor to QNAME.  If such a zone is found, go to step 3,
<span class="anchor" id="line-3-27"></span>      otherwise step 4.</pre><span class="anchor" id="line-547"></span><ul><li style="list-style-type:none">利用可能なゾーン内の QNAMEにもっとも近い祖先ゾーンを探せ。 <span class="anchor" id="line-548"></span>このようなゾーンがあればステップ 3 へ、なければステップ 4 へ。 <span class="anchor" id="line-549"></span></li></ul><p class="line867"><span class="anchor" id="line-550"></span><span class="anchor" id="line-551"></span><span class="anchor" id="line-552"></span></p><pre><span class="anchor" id="line-1-49"></span>   3. Start matching down, label by label, in the zone.  The
<span class="anchor" id="line-2-43"></span>      matching process can terminate several ways:</pre><span class="anchor" id="line-553"></span><ul><li style="list-style-type:none">ゾーン内でラベルをひとつずつ比較していく。 <span class="anchor" id="line-554"></span>比較作業が終了するための条件にはいくつかある： <span class="anchor" id="line-555"></span></li></ul><p class="line867"><span class="anchor" id="line-556"></span><span class="anchor" id="line-557"></span></p><pre><span class="anchor" id="line-1-50"></span>         a. If the whole of QNAME is matched, we have found the node.</pre><span class="anchor" id="line-558"></span><ol type="a"><li>QNAME全体が一致したら、目的のノードを見つけた。 <span class="anchor" id="line-559"></span></li></ol><p class="line867"><span class="anchor" id="line-560"></span><span class="anchor" id="line-561"></span><span class="anchor" id="line-562"></span><span class="anchor" id="line-563"></span><span class="anchor" id="line-564"></span></p><pre><span class="anchor" id="line-1-51"></span>            If the data at the node is a CNAME, and QTYPE doesn't
<span class="anchor" id="line-2-44"></span>            match CNAME, copy the CNAME RR into the answer section
<span class="anchor" id="line-3-28"></span>            of the response, change QNAME to the canonical name in
<span class="anchor" id="line-4-23"></span>            the CNAME RR, and go back to step 1.</pre><span class="anchor" id="line-565"></span><ul><li style="list-style-type:none">ノードのデータがCNAMEであり QTYPEとCNAMEとが一致しないときは、 <span class="anchor" id="line-566"></span>CNAME RR を返事の返答節にコピーし、 <span class="anchor" id="line-567"></span>QNAMEを CNAME RR にある正規名で置き換えて、 <span class="anchor" id="line-568"></span>ステップ1 に戻る。 <span class="anchor" id="line-569"></span></li></ul><p class="line867"><span class="anchor" id="line-570"></span><span class="anchor" id="line-571"></span><span class="anchor" id="line-572"></span></p><pre><span class="anchor" id="line-1-52"></span>            Otherwise, copy all RRs which match QTYPE into the
<span class="anchor" id="line-2-45"></span>            answer section and go to step 6.</pre><span class="anchor" id="line-573"></span><ul><li style="list-style-type:none">そうでなければ、QTYPEと一致するすべての RRs を返答節にコピーし、 <span class="anchor" id="line-574"></span>ステップ6 に行く。 <span class="anchor" id="line-575"></span></li></ul><p class="line867"><span class="anchor" id="line-576"></span><span class="anchor" id="line-577"></span><span class="anchor" id="line-578"></span><span class="anchor" id="line-579"></span><span class="anchor" id="line-580"></span></p><pre><span class="anchor" id="line-1-53"></span>         b. If a match would take us out of the authoritative data,
<span class="anchor" id="line-2-46"></span>            we have a referral.  This happens when we encounter a
<span class="anchor" id="line-3-29"></span>            node with NS RRs marking cuts along the bottom of a
<span class="anchor" id="line-4-24"></span>            zone.</pre><span class="anchor" id="line-581"></span><ul><li style="list-style-type:none">b. 権威あるデータでないところに到達したら、参照を得たことになる。 <span class="anchor" id="line-582"></span><ul><li style="list-style-type:none">ゾーンの下端でカットを示す NS RRs に遭遇した時に発生する。 <span class="anchor" id="line-583"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-584"></span><span class="anchor" id="line-585"></span><span class="anchor" id="line-586"></span><span class="anchor" id="line-587"></span><span class="anchor" id="line-588"></span><span class="anchor" id="line-589"></span></p><pre><span class="anchor" id="line-1-54"></span>            Copy the NS RRs for the subzone into the authority
<span class="anchor" id="line-2-47"></span>            section of the reply.  Put whatever addresses are
<span class="anchor" id="line-3-30"></span>            available into the additional section, using glue RRs
<span class="anchor" id="line-4-25"></span>            if the addresses are not available from authoritative
<span class="anchor" id="line-5-19"></span>            data or the cache.  Go to step 4.</pre><span class="anchor" id="line-590"></span><ul><li style="list-style-type:none">サブゾーンの NS RRs を答の権威節へコピーせよ。 <span class="anchor" id="line-591"></span>利用可能な全てのアドレスを付加節に置く。 <span class="anchor" id="line-592"></span>権威のあるデータやキャッシュ中に必要なアドレスがないなら、 <span class="anchor" id="line-593"></span>グルー RRs を使ってよい。 <span class="anchor" id="line-594"></span>ステップ4に行く。 <span class="anchor" id="line-595"></span></li></ul><p class="line867"><span class="anchor" id="line-596"></span><span class="anchor" id="line-597"></span><span class="anchor" id="line-598"></span><span class="anchor" id="line-599"></span></p><pre><span class="anchor" id="line-1-55"></span>         c. If at some label, a match is impossible (i.e., the
<span class="anchor" id="line-2-48"></span>            corresponding label does not exist), look to see if a
<span class="anchor" id="line-3-31"></span>            the ';*'; label exists.</pre><span class="anchor" id="line-600"></span><ul><li style="list-style-type:none">c. どこかのラベルで比較ができなくなった（つまり対応するラベルが <span class="anchor" id="line-601"></span><ul><li style="list-style-type:none">存在しなくなった)なら、';*';ラベルがあるか調べる。 <span class="anchor" id="line-602"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-603"></span><span class="anchor" id="line-604"></span><span class="anchor" id="line-605"></span><span class="anchor" id="line-606"></span><span class="anchor" id="line-607"></span><span class="anchor" id="line-608"></span></p><pre><span class="anchor" id="line-1-56"></span>            If the ';*'; label does not exist, check whether the name
<span class="anchor" id="line-2-49"></span>            we are looking for is the original QNAME in the query
<span class="anchor" id="line-3-32"></span>            or a name we have followed due to a CNAME.  If the name
<span class="anchor" id="line-4-26"></span>            is original, set an authoritative name error in the
<span class="anchor" id="line-5-20"></span>            response and exit.  Otherwise just exit.</pre><span class="anchor" id="line-609"></span><ul><li style="list-style-type:none">';*';ラベルがないなら、探しているのが元々の問合 <span class="anchor" id="line-610"></span>せのQNAMEであるのか、CNAMEをたどって得た名前なのかを調べよ。 <span class="anchor" id="line-611"></span>名前が元々の名前であれば、返答には権威ある名前エラーを設定、 <span class="anchor" id="line-612"></span>終了する。そうでなければ単に終了する。 <span class="anchor" id="line-613"></span></li></ul><p class="line867"><span class="anchor" id="line-614"></span><span class="anchor" id="line-615"></span><span class="anchor" id="line-616"></span><span class="anchor" id="line-617"></span><span class="anchor" id="line-618"></span></p><pre><span class="anchor" id="line-1-57"></span>            If the ';*'; label does exist, match RRs at that node
<span class="anchor" id="line-2-50"></span>            against QTYPE.  If any match, copy them into the answer
<span class="anchor" id="line-3-33"></span>            section, but set the owner of the RR to be QNAME, and
<span class="anchor" id="line-4-27"></span>            not the node with the ';*'; label.  Go to step 6.</pre><span class="anchor" id="line-619"></span><ul><li style="list-style-type:none">もし';*';ラベルが存在したら、そのノードのRRsをQTYPE <span class="anchor" id="line-620"></span>と比較する。もしどれかの RRs が一致したら、それらを返答節 <span class="anchor" id="line-621"></span>コピーする、ただし、RR の持主は ';*';を持つラベ <span class="anchor" id="line-622"></span>ルではなくQNAMEにセットする。ステップ6へいく。 <span class="anchor" id="line-623"></span></li></ul><p class="line867"><span class="anchor" id="line-624"></span><span class="anchor" id="line-625"></span><span class="anchor" id="line-626"></span><span class="anchor" id="line-627"></span><span class="anchor" id="line-628"></span><span class="anchor" id="line-629"></span></p><pre><span class="anchor" id="line-1-58"></span>   4. Start matching down in the cache.  If QNAME is found in the
<span class="anchor" id="line-2-51"></span>      cache, copy all RRs attached to it that match QTYPE into the
<span class="anchor" id="line-3-34"></span>      answer section.  If there was no delegation from
<span class="anchor" id="line-4-28"></span>      authoritative data, look for the best one from the cache, and
<span class="anchor" id="line-5-21"></span>      put it in the authority section.  Go to step 6.</pre><span class="anchor" id="line-630"></span><ul><li style="list-style-type:none">キャッシュ内を探す。QNAMEがキャッシュで発見されたら、 <span class="anchor" id="line-631"></span>それに付随する RRs のうち、QTYPEと一致するものを返答節へコピーする。 <span class="anchor" id="line-632"></span>もし権威あるデータからの委譲がないときには、キャッシュの中から <span class="anchor" id="line-633"></span>最もいいものを探して、それを権威節に入れる。 <span class="anchor" id="line-634"></span>ステップ6 へ行く。 <span class="anchor" id="line-635"></span></li></ul><p class="line867"><span class="anchor" id="line-636"></span><span class="anchor" id="line-637"></span><span class="anchor" id="line-638"></span><span class="anchor" id="line-639"></span><span class="anchor" id="line-640"></span></p><pre><span class="anchor" id="line-1-59"></span>   5. Using the local resolver or a copy of its algorithm (see
<span class="anchor" id="line-2-52"></span>      resolver section of this memo) to answer the query.  Store
<span class="anchor" id="line-3-35"></span>      the results, including any intermediate CNAMEs, in the answer
<span class="anchor" id="line-4-29"></span>      section of the response.</pre><span class="anchor" id="line-641"></span><ul><li style="list-style-type:none">ローカルリゾルバを使うか、リゾルバのアルゴリズム（この文書のリゾル <span class="anchor" id="line-642"></span>バの節を見よ）を使うかして問合せに答える。 <span class="anchor" id="line-643"></span>途中に現われた CNAMEも含めて、結果を返事の返答節に置く。 <span class="anchor" id="line-644"></span></li></ul><p class="line867"><span class="anchor" id="line-645"></span><span class="anchor" id="line-646"></span><span class="anchor" id="line-647"></span></p><pre><span class="anchor" id="line-1-60"></span>   6. Using local data only, attempt to add other RRs which may be
<span class="anchor" id="line-2-53"></span>      useful to the additional section of the query.  Exit.</pre><span class="anchor" id="line-648"></span><ul><li style="list-style-type:none">ローカルなデータだけを使って、有用そうなその他のRRsを <span class="anchor" id="line-649"></span>付加節に加える。終了する。 <span class="anchor" id="line-650"></span><span class="anchor" id="line-651"></span></li></ul><p class="line867"><span class="anchor" id="A17"></span> <span class="anchor" id="line-652"></span>4.3.3. ワイルドカード Wildcards <span class="anchor" id="line-653"></span><span class="anchor" id="line-654"></span><span class="anchor" id="line-655"></span><span class="anchor" id="line-656"></span><span class="anchor" id="line-657"></span><span class="anchor" id="line-658"></span><span class="anchor" id="line-659"></span><span class="anchor" id="line-660"></span></p><pre><span class="anchor" id="line-1-61"></span>In the previous algorithm, special treatment was given to RRs with owner
<span class="anchor" id="line-2-54"></span>names starting with the label ';*';.  Such RRs are called wildcards.
<span class="anchor" id="line-3-36"></span>Wildcard RRs can be thought of as instructions for synthesizing RRs.
<span class="anchor" id="line-4-30"></span>When the appropriate conditions are met, the name server creates RRs
<span class="anchor" id="line-5-22"></span>with an owner name equal to the query name and contents taken from the
<span class="anchor" id="line-6-12"></span>wildcard RRs.</pre><span class="anchor" id="line-661"></span><p class="line874">前節のアルゴリズムで ';*'; ラベルで始まる所有者名をもつRRsには <span class="anchor" id="line-662"></span>特別な処置がなされた。 <span class="anchor" id="line-663"></span>このような RRs はワイルドカードと呼ばれる。 <span class="anchor" id="line-664"></span>ワイルドカード RRs は RRs を合成するための指示と考えらる。 <span class="anchor" id="line-665"></span>適切な条件を満たす時、ネームサーバは問合せの名前と一致した所有者名をもち <span class="anchor" id="line-666"></span>ワイルドカード RRs の内容をもつ RRs を生成する。 <span class="anchor" id="line-667"></span><span class="anchor" id="line-668"></span><span class="anchor" id="line-669"></span><span class="anchor" id="line-670"></span><span class="anchor" id="line-671"></span><span class="anchor" id="line-672"></span><span class="anchor" id="line-673"></span><span class="anchor" id="line-674"></span><span class="anchor" id="line-675"></span><span class="anchor" id="line-676"></span></p><pre><span class="anchor" id="line-1-62"></span>This facility is most often used to create a zone which will be used to
<span class="anchor" id="line-2-55"></span>forward mail from the Internet to some other mail system.  The general
<span class="anchor" id="line-3-37"></span>idea is that any name in that zone which is presented to server in a
<span class="anchor" id="line-4-31"></span>query will be assumed to exist, with certain properties, unless explicit
<span class="anchor" id="line-5-23"></span>evidence exists to the contrary.  Note that the use of the term zone
<span class="anchor" id="line-6-13"></span>here, instead of domain, is intentional; such defaults do not propagate
<span class="anchor" id="line-7-9"></span>across zone boundaries, although a subzone may choose to achieve that
<span class="anchor" id="line-8-7"></span>appearance by setting up similar defaults.</pre><span class="anchor" id="line-677"></span><p class="line874">この機能はインターネットから別種のメールシステム(訳注：UUCP など)へ <span class="anchor" id="line-678"></span>メールを転送するために使うゾーンを生成するのによく使われる。 <span class="anchor" id="line-679"></span>そのゾーンに属する名前の問合せがサーバにやってきたら、 <span class="anchor" id="line-680"></span>反対の指定がされているのでないかぎり、 <span class="anchor" id="line-681"></span>どういう名前であろうとある属性をもって存在するというのが <span class="anchor" id="line-682"></span>一般的な考えである。 <span class="anchor" id="line-683"></span>ここで、ドメインではなく、 <span class="anchor" id="line-684"></span>ゾーンという言葉を使ったのは意図的であることに注意せよ; <span class="anchor" id="line-685"></span>このようなデフォルトはゾーン境界を越えて伝わることはない。 <span class="anchor" id="line-686"></span>ただし、サブゾーンは類似のデフォルトを設定することで、 <span class="anchor" id="line-687"></span>そのように見えるようにするかもしれない。 <span class="anchor" id="line-688"></span><span class="anchor" id="line-689"></span><span class="anchor" id="line-690"></span><span class="anchor" id="line-691"></span><span class="anchor" id="line-692"></span><span class="anchor" id="line-693"></span><span class="anchor" id="line-694"></span><span class="anchor" id="line-695"></span><span class="anchor" id="line-696"></span><span class="anchor" id="line-697"></span><span class="anchor" id="line-698"></span></p><pre><span class="anchor" id="line-1-63"></span>The contents of the wildcard RRs follows the usual rules and formats for
<span class="anchor" id="line-2-56"></span>RRs.  The wildcards in the zone have an owner name that controls the
<span class="anchor" id="line-3-38"></span>query names they will match.  The owner name of the wildcard RRs is of
<span class="anchor" id="line-4-32"></span>the form ';*.&lt;anydomain&gt;';, where &lt;anydomain&gt; is any domain name.
<span class="anchor" id="line-5-24"></span>&lt;anydomain&gt; should not contain other * labels, and should be in the
<span class="anchor" id="line-6-14"></span>authoritative data of the zone.  The wildcards potentially apply to
<span class="anchor" id="line-7-10"></span>descendants of &lt;anydomain&gt;, but not to &lt;anydomain&gt; itself.  Another way
<span class="anchor" id="line-8-8"></span>to look at this is that the ';*'; label always matches at least one whole
<span class="anchor" id="line-9-5"></span>label and sometimes more, but always whole labels.</pre><span class="anchor" id="line-699"></span><p class="line874">ワイルドカードRRsの中身は通常の RRs の規則と形式に従う。 <span class="anchor" id="line-700"></span>ゾーン中のワイルドカードは適合する問合せ名を操作する所有者名を持つ。 <span class="anchor" id="line-701"></span>ワイルドカード RRs の所有者名は ';*.&lt;anydomain&gt;';という形式であり、 <span class="anchor" id="line-702"></span>ここで &lt;anydomain&gt; は任意のドメイン名である。 <span class="anchor" id="line-703"></span>&lt;anydomain&gt; は他の * ラベルを含んではならず、 <span class="anchor" id="line-704"></span>ゾーンの権威あるデータのものでなければならない。 <span class="anchor" id="line-705"></span>ワイルドカードは&lt;anydomain&gt;の子孫にも適用される可能性があるが、 <span class="anchor" id="line-706"></span>&lt;anydomain&gt;自身には適用されない。 <span class="anchor" id="line-707"></span>別の見方をすると、 <span class="anchor" id="line-708"></span>';*';ラベルは 1つ以上のラベル(全体)に一致し、 <span class="anchor" id="line-709"></span>ラベルの一部分には一致はしないということになる。 <span class="anchor" id="line-710"></span><span class="anchor" id="line-711"></span><span class="anchor" id="line-712"></span></p><pre><span class="anchor" id="line-1-64"></span>Wildcard RRs do not apply:</pre><span class="anchor" id="line-713"></span><p class="line874">ワイルドカード RR は以下のものにはあてはまらない： <span class="anchor" id="line-714"></span><span class="anchor" id="line-715"></span><span class="anchor" id="line-716"></span><span class="anchor" id="line-717"></span></p><pre><span class="anchor" id="line-1-65"></span>   - When the query is in another zone.  That is, delegation cancels
<span class="anchor" id="line-2-57"></span>     the wildcard defaults.</pre><span class="anchor" id="line-718"></span><ul><li style="list-style-type:none">- 問合せが他のゾーンに対するものである。 <span class="anchor" id="line-719"></span><ul><li style="list-style-type:none">つまり委譲があると、ワイルドカードデフォルトは効果がなくなる。 <span class="anchor" id="line-720"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-721"></span><span class="anchor" id="line-722"></span><span class="anchor" id="line-723"></span><span class="anchor" id="line-724"></span><span class="anchor" id="line-725"></span><span class="anchor" id="line-726"></span><span class="anchor" id="line-727"></span></p><pre><span class="anchor" id="line-1-66"></span>   - When the query name or a name between the wildcard domain and
<span class="anchor" id="line-2-58"></span>     the query name is know to exist.  For example, if a wildcard
<span class="anchor" id="line-3-39"></span>     RR has an owner name of ';*.X';, and the zone also contains RRs
<span class="anchor" id="line-4-33"></span>     attached to B.X, the wildcards would apply to queries for name
<span class="anchor" id="line-5-25"></span>     Z.X (presuming there is no explicit information for Z.X), but
<span class="anchor" id="line-6-15"></span>     not to B.X, A.B.X, or X.</pre><span class="anchor" id="line-728"></span><ul><li style="list-style-type:none">- 問合せ名の存在がすでに分っていたり、 <span class="anchor" id="line-729"></span><ul><li style="list-style-type:none">ワールドカードドメインと問合せ名の間の名前の存在が分っているとき。 <span class="anchor" id="line-730"></span>例えば、ワイルドカード RRs の所有者名が ';*.X';であり、 <span class="anchor" id="line-731"></span>ゾーン内に B.XのRRsがある場合、 <span class="anchor" id="line-732"></span>ワイルドカードは Z.X には適用される（Z.X の明示的情報はないものとして）が <span class="anchor" id="line-733"></span>B.X, A.B.X, X などには適用されない。 <span class="anchor" id="line-734"></span></li></ul></li></ul><p class="line867"><span class="anchor" id="line-735"></span><span class="anchor" id="line-736"></span><span class="anchor" id="line-737"></span><span class="anchor" id="line-738"></span><span class="anchor" id="line-739"></span></p><pre><span class="anchor" id="line-1-67"></span>A * label appearing in a query name has no special effect, but can be
<span class="anchor" id="line-2-59"></span>used to test for wildcards in an authoritative zone; such a query is the
<span class="anchor" id="line-3-40"></span>only way to get a response containing RRs with an owner name with * in
<span class="anchor" id="line-4-34"></span>it.  The result of such a query should not be cached.</pre><span class="anchor" id="line-740"></span><p class="line874">問合せ名中に現われる * ラベルは特別な効果を持たないが、 <span class="anchor" id="line-741"></span>権威あるなゾーン中でワイルドカードのテストをするときに使える; <span class="anchor" id="line-742"></span>このような問合せは所有者名に * を含む RRs の返答を得る唯一の方法である。 <span class="anchor" id="line-743"></span>このような問合せの結果はキャッシュしてはならない。 <span class="anchor" id="line-744"></span><span class="anchor" id="line-745"></span><span class="anchor" id="line-746"></span><span class="anchor" id="line-747"></span></p><pre><span class="anchor" id="line-1-68"></span>Note that the contents of the wildcard RRs are not modified when used to
<span class="anchor" id="line-2-60"></span>synthesize RRs.</pre><span class="anchor" id="line-748"></span><p class="line874">RRsを生成するために使われるとき、ワイルドカード RRs の中身は <span class="anchor" id="line-749"></span>修正されないことに注意せよ。 <span class="anchor" id="line-750"></span><span class="anchor" id="line-751"></span><span class="anchor" id="line-752"></span><span class="anchor" id="line-753"></span><span class="anchor" id="line-754"></span><span class="anchor" id="line-755"></span></p><pre><span class="anchor" id="line-1-69"></span>To illustrate the use of wildcard RRs, suppose a large company with a
<span class="anchor" id="line-2-61"></span>large, non-IP/TCP, network wanted to create a mail gateway.  If the
<span class="anchor" id="line-3-41"></span>company was called X.COM, and IP/TCP capable gateway machine was called
<span class="anchor" id="line-4-35"></span>A.X.COM, the following RRs might be entered into the COM zone:</pre><span class="anchor" id="line-756"></span><p class="line874">ワイルドカード RRs の使用例を示すために、 <span class="anchor" id="line-757"></span>大きな非IP/TCP網を持つ大きな会社がメールゲートウェイを作ろうとしているとする。 <span class="anchor" id="line-758"></span>会社は X.COM と呼ばれていて、 TP/TCPを持つゲートウェイマシンは <span class="anchor" id="line-759"></span>A.X.COMと呼ばれるとしたら、以下のRRs を COMゾーンに登録するだろう: <span class="anchor" id="line-760"></span><span class="anchor" id="line-761"></span></p><p class="line867"><span class="anchor" id="line-762"></span><span class="anchor" id="line-763"></span><span class="anchor" id="line-764"></span><span class="anchor" id="line-765"></span><span class="anchor" id="line-766"></span><span class="anchor" id="line-767"></span><span class="anchor" id="line-768"></span><span class="anchor" id="line-769"></span><span class="anchor" id="line-770"></span></p><pre><span class="anchor" id="line-1-70"></span>    X.COM           MX      10      A.X.COM
<span class="anchor" id="line-2-62"></span>
<span class="anchor" id="line-3-42"></span>    *.X.COM         MX      10      A.X.COM
<span class="anchor" id="line-4-36"></span>
<span class="anchor" id="line-5-26"></span>    A.X.COM         A       1.2.3.4
<span class="anchor" id="line-6-16"></span>    A.X.COM         MX      10      A.X.COM
<span class="anchor" id="line-7-11"></span>
<span class="anchor" id="line-8-9"></span>    *.A.X.COM       MX      10      A.X.COM</pre><span class="anchor" id="line-771"></span><p class="line867"><span class="anchor" id="line-772"></span><span class="anchor" id="line-773"></span><span class="anchor" id="line-774"></span><span class="anchor" id="line-775"></span><span class="anchor" id="line-776"></span><span class="anchor" id="line-777"></span><span class="anchor" id="line-778"></span></p><pre><span class="anchor" id="line-1-71"></span>This would cause any MX query for any domain name ending in X.COM to
<span class="anchor" id="line-2-63"></span>return an MX RR pointing at A.X.COM.  Two wildcard RRs are required
<span class="anchor" id="line-3-43"></span>since the effect of the wildcard at *.X.COM is inhibited in the A.X.COM
<span class="anchor" id="line-4-37"></span>subtree by the explicit data for A.X.COM.  Note also that the explicit
<span class="anchor" id="line-5-27"></span>MX data at X.COM and A.X.COM is required, and that none of the RRs above
<span class="anchor" id="line-6-17"></span>would match a query name of XX.COM.</pre><span class="anchor" id="line-779"></span><p class="line874">この指定により、 <span class="anchor" id="line-780"></span>X.COMで終わるドメイン名についの MX 問合せをすれば、いつでも、 <span class="anchor" id="line-781"></span>A.X.COM を指す MX RRs が返ってくることになる。 <span class="anchor" id="line-782"></span>A.X.COMに対する明示的データがあるので A.X.COM の部分木には <span class="anchor" id="line-783"></span>*.X.COMの効果が及ばないため、ワイルドカード RRs は二つ必要になる。 <span class="anchor" id="line-784"></span>X.COMとA.X.COMについても明示的なMXデータが必要であることと <span class="anchor" id="line-785"></span>上記のどの RRs も XX.COM の問合せには一致しないことに注意せよ。 <span class="anchor" id="line-786"></span><span class="anchor" id="line-787"></span></p><p class="line867"><span class="anchor" id="A18"></span> <span class="anchor" id="line-788"></span>4.3.4. 否定応答のキャッシュ（任意） Negative response caching (Optional) <span class="anchor" id="line-789"></span><span class="anchor" id="line-790"></span><span class="anchor" id="line-791"></span><span class="anchor" id="line-792"></span><span class="anchor" id="line-793"></span><span class="anchor" id="line-794"></span><span class="anchor" id="line-795"></span><span class="anchor" id="line-796"></span><span class="anchor" id="line-797"></span><span class="anchor" id="line-798"></span></p><pre><span class="anchor" id="line-1-72"></span>The DNS provides an optional service which allows name servers to
<span class="anchor" id="line-2-64"></span>distribute, and resolvers to cache, negative results with TTLs.  For
<span class="anchor" id="line-3-44"></span>example, a name server can distribute a TTL along with a name error
<span class="anchor" id="line-4-38"></span>indication, and a resolver receiving such information is allowed to
<span class="anchor" id="line-5-28"></span>assume that the name does not exist during the TTL period without
<span class="anchor" id="line-6-18"></span>consulting authoritative data.  Similarly, a resolver can make a query
<span class="anchor" id="line-7-12"></span>with a QTYPE which matches multiple types, and cache the fact that some
<span class="anchor" id="line-8-10"></span>of the types are not present.</pre><span class="anchor" id="line-799"></span><p class="line874">DNS には <span class="anchor" id="line-800"></span>ネームサーバが TTL 付きの否定返答を送り、リゾルバがキャッシュすることを <span class="anchor" id="line-801"></span>認めるという任意実装のサービスがある。 <span class="anchor" id="line-802"></span>例えば、ネームサーバは名前エラー表示とともにTTLを送ることができる。 <span class="anchor" id="line-803"></span>そして、この情報を受け取ったリゾルバは TTL時間の間、 <span class="anchor" id="line-804"></span>権威あるデータを調べることなく、その名前が存在しないと判定することが許される。 <span class="anchor" id="line-805"></span>同様に、リゾルバは複数のタイプと一致するQTYPEを持つ問い合わせをして、 <span class="anchor" id="line-806"></span>いくつかのタイプが存在しないという事実をキャッシュしてよい。 <span class="anchor" id="line-807"></span><span class="anchor" id="line-808"></span><span class="anchor" id="line-809"></span><span class="anchor" id="line-810"></span><span class="anchor" id="line-811"></span><span class="anchor" id="line-812"></span></p><pre><span class="anchor" id="line-1-73"></span>This feature can be particularly important in a system which implements
<span class="anchor" id="line-2-65"></span>naming shorthands that use search lists beacuse a popular shorthand,
<span class="anchor" id="line-3-45"></span>which happens to require a suffix toward the end of the search list,
<span class="anchor" id="line-4-39"></span>will generate multiple name errors whenever it is used.</pre><span class="anchor" id="line-813"></span><p class="line874">この機能は検索リストで使って名前短縮を実装するようなシステムで <span class="anchor" id="line-814"></span>特に重要でありえる。 <span class="anchor" id="line-815"></span>そのわけはよく使われる名前の <span class="anchor" id="line-816"></span>短縮法では、捜索リストの末尾にむかっての接尾辞を必要としていて、 <span class="anchor" id="line-817"></span>使用時に複数の名前エラーを生じるからである。 <span class="anchor" id="line-818"></span><span class="anchor" id="line-819"></span><span class="anchor" id="line-820"></span><span class="anchor" id="line-821"></span><span class="anchor" id="line-822"></span><span class="anchor" id="line-823"></span><span class="anchor" id="line-824"></span><span class="anchor" id="line-825"></span></p><pre><span class="anchor" id="line-1-74"></span>The method is that a name server may add an SOA RR to the additional
<span class="anchor" id="line-2-66"></span>section of a response when that response is authoritative.  The SOA must
<span class="anchor" id="line-3-46"></span>be that of the zone which was the source of the authoritative data in
<span class="anchor" id="line-4-40"></span>the answer section, or name error if applicable.  The MINIMUM field of
<span class="anchor" id="line-5-29"></span>the SOA controls the length of time that the negative result may be
<span class="anchor" id="line-6-19"></span>cached.</pre><span class="anchor" id="line-826"></span><p class="line874">実現の方法はネームサーバが <span class="anchor" id="line-827"></span>権威ある返答をするときに返事の付加節に SOA RRs を付け加えてもよい <span class="anchor" id="line-828"></span>というものである。 <span class="anchor" id="line-829"></span>このSOA は返答節中の権威あるデータやネームエラーの生成源であるゾーンのもの <span class="anchor" id="line-830"></span>でなければならない。 <span class="anchor" id="line-831"></span>SOAの MINUMUM フィールドが否定の結果をキャッシュしてよい時間の長さを決める。 <span class="anchor" id="line-832"></span><span class="anchor" id="line-833"></span><span class="anchor" id="line-834"></span><span class="anchor" id="line-835"></span><span class="anchor" id="line-836"></span><span class="anchor" id="line-837"></span></p><pre><span class="anchor" id="line-1-75"></span>Note that in some circumstances, the answer section may contain multiple
<span class="anchor" id="line-2-67"></span>owner names.  In this case, the SOA mechanism should only be used for
<span class="anchor" id="line-3-47"></span>the data which matches QNAME, which is the only authoritative data in
<span class="anchor" id="line-4-41"></span>this section.</pre><span class="anchor" id="line-838"></span><p class="line874">返答節が複数の所有者名を持つ状況があることに注意せよ。 <span class="anchor" id="line-839"></span>この場合、SOA メカニズムは QNAME に適合するデータだけに使われるべきである。 <span class="anchor" id="line-840"></span>それはこの節中の唯一の権威あるデータである。 <span class="anchor" id="line-841"></span><span class="anchor" id="line-842"></span><span class="anchor" id="line-843"></span><span class="anchor" id="line-844"></span><span class="anchor" id="line-845"></span><span class="anchor" id="line-846"></span><span class="anchor" id="line-847"></span><span class="anchor" id="line-848"></span><span class="anchor" id="line-849"></span></p><pre><span class="anchor" id="line-1-76"></span>Name servers and resolvers should never attempt to add SOAs to the
<span class="anchor" id="line-2-68"></span>additional section of a non-authoritative response, or attempt to infer
<span class="anchor" id="line-3-48"></span>results which are not directly stated in an authoritative response.
<span class="anchor" id="line-4-42"></span>There are several reasons for this, including: cached information isn't
<span class="anchor" id="line-5-30"></span>usually enough to match up RRs and their zone names, SOA RRs may be
<span class="anchor" id="line-6-20"></span>cached due to direct SOA queries, and name servers are not required to
<span class="anchor" id="line-7-13"></span>output the SOAs in the authority section.</pre><span class="anchor" id="line-850"></span><p class="line874">ネームサーバとリゾルバは権威のない返答の付加節にSOAを加えたり、 <span class="anchor" id="line-851"></span>権威のある返答で直接言われていない結果を導いたりしてはならない。 <span class="anchor" id="line-852"></span><span class="anchor" id="line-853"></span></p><p class="line874">これにはいくつか理由がある: <span class="anchor" id="line-854"></span>キャッシュされた情報は RRs とそのゾーン名をマッチさせるのに十分でない、 <span class="anchor" id="line-855"></span>SOA RRs は SOA を直接問い合わせることでキャッシュされる、 <span class="anchor" id="line-856"></span>ネームサーバは権威節に SOA を答ることを要求されてない。 <span class="anchor" id="line-857"></span>など。 <span class="anchor" id="line-858"></span><span class="anchor" id="line-859"></span><span class="anchor" id="line-860"></span><span class="anchor" id="line-861"></span><span class="anchor" id="line-862"></span><span class="anchor" id="line-863"></span><span class="anchor" id="line-864"></span><span class="anchor" id="line-865"></span></p><pre><span class="anchor" id="line-1-77"></span>This feature is optional, although a refined version is expected to
<span class="anchor" id="line-2-69"></span>become part of the standard protocol in the future.  Name servers are
<span class="anchor" id="line-3-49"></span>not required to add the SOA RRs in all authoritative responses, nor are
<span class="anchor" id="line-4-43"></span>resolvers required to cache negative results.  Both are recommended.
<span class="anchor" id="line-5-31"></span>All resolvers and recursive name servers are required to at least be
<span class="anchor" id="line-6-21"></span>able to ignore the SOA RR when it is present in a response.</pre><span class="anchor" id="line-866"></span><p class="line874">この機能は実装任意であるが、 <span class="anchor" id="line-867"></span>将来、改訂されたバージョンでは <span class="anchor" id="line-868"></span>標準プロトコルの一部になると期待される。 <span class="anchor" id="line-869"></span><span class="anchor" id="line-870"></span></p><p class="line874">ネームサーバは権威ある返答に SOA RRs を加えるように要求されていないし、 <span class="anchor" id="line-871"></span>リゾルバは否定的結果をキャッシュすることを要求されていない。 <span class="anchor" id="line-872"></span><span class="anchor" id="line-873"></span></p><p class="line874">両方とも推奨されている。 <span class="anchor" id="line-874"></span><span class="anchor" id="line-875"></span></p><p class="line874">リゾルバと再帰ネームサーバは 返答に SOA RRs が存在している時、 <span class="anchor" id="line-876"></span>それを無視できることが必要である。 <span class="anchor" id="line-877"></span><span class="anchor" id="line-878"></span><span class="anchor" id="line-879"></span><span class="anchor" id="line-880"></span><span class="anchor" id="line-881"></span><span class="anchor" id="line-882"></span><span class="anchor" id="line-883"></span><span class="anchor" id="line-884"></span><span class="anchor" id="line-885"></span></p><pre><span class="anchor" id="line-1-78"></span>Some experiments have also been proposed which will use this feature.
<span class="anchor" id="line-2-70"></span>The idea is that if cached data is known to come from a particular zone,
<span class="anchor" id="line-3-50"></span>and if an authoritative copy of the zone's SOA is obtained, and if the
<span class="anchor" id="line-4-44"></span>zone's SERIAL has not changed since the data was cached, then the TTL of
<span class="anchor" id="line-5-32"></span>the cached data can be reset to the zone MINIMUM value if it is smaller.
<span class="anchor" id="line-6-22"></span>This usage is mentioned for planning purposes only, and is not
<span class="anchor" id="line-7-14"></span>recommended as yet.</pre><span class="anchor" id="line-886"></span><p class="line874">この機能を使う実験も提案されている。 <span class="anchor" id="line-887"></span>考え方は次のようなものである。 <span class="anchor" id="line-888"></span>キャッシュされたデータが来たゾーンがわかっていて、 <span class="anchor" id="line-889"></span>そのゾーンのSOAの権威あるコピーが得られ、 <span class="anchor" id="line-890"></span>ゾーンのシリアル番号がデータがキャッシュされて以来変更されていなければ、 <span class="anchor" id="line-891"></span>キャッシュデータのTTLはゾーンのMINIMUM 値より小さければ、 <span class="anchor" id="line-892"></span>MINIMUM値で置き換えてよい。 <span class="anchor" id="line-893"></span><span class="anchor" id="line-894"></span></p><p class="line874">この使用法は計画が目的で触れられていて、まだ推奨できるものではない。 <span class="anchor" id="line-895"></span><span class="anchor" id="line-896"></span></p><p class="line867"><span class="anchor" id="A19"></span> <span class="anchor" id="line-897"></span>4.3.5. ゾーンの保守管理と転送 Zone maintenance and transfers <span class="anchor" id="line-898"></span><span class="anchor" id="line-899"></span><span class="anchor" id="line-900"></span><span class="anchor" id="line-901"></span><span class="anchor" id="line-902"></span><span class="anchor" id="line-903"></span><span class="anchor" id="line-904"></span></p><pre><span class="anchor" id="line-1-79"></span>Part of the job of a zone administrator is to maintain the zones at all of
<span class="anchor" id="line-2-71"></span>the name servers which are authoritative for the zone. When the inevitable
<span class="anchor" id="line-3-51"></span>changes are made, they must be distributed to all of the name servers. While
<span class="anchor" id="line-4-45"></span>this distribution can be accomplished using FTP or some other ad hoc
<span class="anchor" id="line-5-33"></span>procedure, the preferred method is the zone transfer part of the DNS protocol.</pre><span class="anchor" id="line-905"></span><p class="line874">ゾーン管理者の仕事の一つは <span class="anchor" id="line-906"></span>ゾーンの権威あるネームサーバのすべてにおいて、 <span class="anchor" id="line-907"></span>ゾーンを維持管理することである。 <span class="anchor" id="line-908"></span>必要な変更が行われたときに、 <span class="anchor" id="line-909"></span>それを全てのネームサーバに配らなくてはならない。 <span class="anchor" id="line-910"></span><span class="anchor" id="line-911"></span></p><p class="line874">配布は FTP やその他のアドホックな方法で可能だが、 <span class="anchor" id="line-912"></span>DNS プロトコルのゾーン転送を使う方が望ましい。 <span class="anchor" id="line-913"></span><span class="anchor" id="line-914"></span><span class="anchor" id="line-915"></span><span class="anchor" id="line-916"></span><span class="anchor" id="line-917"></span><span class="anchor" id="line-918"></span><span class="anchor" id="line-919"></span><span class="anchor" id="line-920"></span><span class="anchor" id="line-921"></span></p><pre><span class="anchor" id="line-1-80"></span> The general model of automatic zone transfer or refreshing is that one of the
<span class="anchor" id="line-2-72"></span>name servers is the master or primary for the zone. Changes are coordinated at
<span class="anchor" id="line-3-52"></span>the primary, typically by editing a master file for the zone. After editing,
<span class="anchor" id="line-4-46"></span>the administrator signals the master server to load the new zone. The other
<span class="anchor" id="line-5-34"></span>non-master or secondary servers for the zone periodically check for changes
<span class="anchor" id="line-6-23"></span>(at a selectable interval) and obtain new zone copies when changes have been
<span class="anchor" id="line-7-15"></span>made.</pre><span class="anchor" id="line-922"></span><p class="line874">自動的なゾーン転送や更新の一般モデルでは <span class="anchor" id="line-923"></span>ネームサーバのうちのひとつがゾーンのマスターあるいはプライマリである。 <span class="anchor" id="line-924"></span>変更はゾーンのマスターファイルを編集するなどプライマリに集約される。 <span class="anchor" id="line-925"></span>編集の後、マスターサーバに新しいゾーンを読み込むよう指示する。 <span class="anchor" id="line-926"></span>ゾーンの他の非マスターあるいはセカンダリサーバは定期的に変更の有無を調べ、 <span class="anchor" id="line-927"></span>(選択可能な間隔で）、変更されているときは新しいゾーンのコピーを得る。 <span class="anchor" id="line-928"></span><span class="anchor" id="line-929"></span><span class="anchor" id="line-930"></span><span class="anchor" id="line-931"></span><span class="anchor" id="line-932"></span><span class="anchor" id="line-933"></span><span class="anchor" id="line-934"></span><span class="anchor" id="line-935"></span><span class="anchor" id="line-936"></span><span class="anchor" id="line-937"></span><span class="anchor" id="line-938"></span><span class="anchor" id="line-939"></span><span class="anchor" id="line-940"></span><span class="anchor" id="line-941"></span></p><pre><span class="anchor" id="line-1-81"></span>To detect changes, secondaries just check the SERIAL field of the SOA for
<span class="anchor" id="line-2-73"></span>the zone. In addition to whatever other changes are made, the SERIAL field in
<span class="anchor" id="line-3-53"></span>the SOA of the zone is always advanced whenever any change is made to the
<span class="anchor" id="line-4-47"></span>zone. The advancing can be a simple increment, or could be based on the write
<span class="anchor" id="line-5-35"></span>date and time of the master file, etc. The purpose is to make it possible to
<span class="anchor" id="line-6-24"></span>determine which of two copies of a zone is more recent by comparing serial
<span class="anchor" id="line-7-16"></span>numbers. Serial number advances and comparisons use sequence space arithmetic,
<span class="anchor" id="line-8-11"></span>so there is a theoretic limit on how fast a zone can be updated, basically
<span class="anchor" id="line-9-6"></span>that old copies must die out before the serial number covers half of its 32
<span class="anchor" id="line-10-3"></span>bit range. In practice, the only concern is that the compare operation deals
<span class="anchor" id="line-11-1"></span>properly with comparisons around the boundary between the most positive and
<span class="anchor" id="line-12-1"></span>most negative 32 bit numbers.</pre><span class="anchor" id="line-942"></span><p class="line874">変更を検出するにはセカンダリはゾーンの SOA シリアルフィールドを調べるだけだ。 <span class="anchor" id="line-943"></span>何かゾーンを変更した場合にはかならずゾーンのSOAのシリアル番号を増加させる。 <span class="anchor" id="line-944"></span>増加は単純な増分であったり、マスターファイルの書き込み日時を使ったもの <span class="anchor" id="line-945"></span>ゾーンのシリアル番号を比較することで、どちらが最近であるかを決定 <span class="anchor" id="line-946"></span>できるようにすることが目的である。 <span class="anchor" id="line-947"></span>シリアル番号の増加と比較には順序空間算術を使うので、 <span class="anchor" id="line-948"></span>ゾーンを更新する速度には理論的な上限がある。 <span class="anchor" id="line-949"></span>基本的に、古いコピーはシリアル番号が 32 ビットで表わされる範囲の半分を過ぎる <span class="anchor" id="line-950"></span>前に消滅していなければならない。 <span class="anchor" id="line-951"></span><span class="anchor" id="line-952"></span></p><p class="line874">実際には、唯一の関心時は32 ビット数において、正の最大値と負の最小値付近での <span class="anchor" id="line-953"></span>比較操作が正しく行われる事である。 <span class="anchor" id="line-954"></span><span class="anchor" id="line-955"></span><span class="anchor" id="line-956"></span><span class="anchor" id="line-957"></span><span class="anchor" id="line-958"></span><span class="anchor" id="line-959"></span><span class="anchor" id="line-960"></span><span class="anchor" id="line-961"></span><span class="anchor" id="line-962"></span><span class="anchor" id="line-963"></span><span class="anchor" id="line-964"></span><span class="anchor" id="line-965"></span><span class="anchor" id="line-966"></span></p><pre><span class="anchor" id="line-1-82"></span> The periodic polling of the secondary servers is controlled by parameters in
<span class="anchor" id="line-2-74"></span>the SOA RR for the zone, which set the minimum acceptable polling intervals.
<span class="anchor" id="line-3-54"></span>The parameters are called REFRESH, RETRY, and EXPIRE. Whenever a new zone is
<span class="anchor" id="line-4-48"></span>loaded in a secondary, the secondary waits REFRESH seconds before checking
<span class="anchor" id="line-5-36"></span>with the primary for a new serial. If this check cannot be completed, new
<span class="anchor" id="line-6-25"></span>checks are started every RETRY seconds. The check is a simple query to the
<span class="anchor" id="line-7-17"></span>primary for the SOA RR of the zone. If the serial field in the secondary's
<span class="anchor" id="line-8-12"></span>zone copy is equal to the serial returned by the primary, then no changes have
<span class="anchor" id="line-9-7"></span>occurred, and the REFRESH interval wait is restarted. If the secondary finds
<span class="anchor" id="line-10-4"></span>it impossible to perform a serial check for the EXPIRE interval, it must
<span class="anchor" id="line-11-2"></span>assume that its copy of the zone is obsolete an discard it.</pre><span class="anchor" id="line-967"></span><p class="line874">セカンダリサーバが行う周期的確認はゾーンの SOA RRs のパラメータで制御される。 <span class="anchor" id="line-968"></span>SOA RRs では問い合わせる間隔を設定する。 <span class="anchor" id="line-969"></span>パラメータは更新(REFRESH)、再試(RETRY)、満期(EXPIRE)と呼ばれる。 <span class="anchor" id="line-970"></span>新しいゾーンがセカンダリにロードされたらいつでも、 <span class="anchor" id="line-971"></span>セカンダリは REFRESH 秒以上待ってから、プライマリのシリアル <span class="anchor" id="line-972"></span>番号があたらしくなっているか、調べる。 <span class="anchor" id="line-973"></span>この確認が完了しなかったときには、RETRY秒後に再度確認操作を行う。 <span class="anchor" id="line-974"></span>確認操作はゾーンのプライマリに SOA RR を問い合わせるだけである。 <span class="anchor" id="line-975"></span>セカンダリにあるゾーンのコピーのシリアルフィールドが <span class="anchor" id="line-976"></span>プライマリからのものと等しければ、変更はなかったことになり、 <span class="anchor" id="line-977"></span>REFRESH 秒待つことが再開される。 <span class="anchor" id="line-978"></span>EXPIRE 秒の間、シリアルチェックできなかった場合には、 <span class="anchor" id="line-979"></span>ゾーンのコピーは有効期限ぎれとして、廃棄しなければならない。 <span class="anchor" id="line-980"></span><span class="anchor" id="line-981"></span><span class="anchor" id="line-982"></span><span class="anchor" id="line-983"></span><span class="anchor" id="line-984"></span><span class="anchor" id="line-985"></span><span class="anchor" id="line-986"></span><span class="anchor" id="line-987"></span><span class="anchor" id="line-988"></span><span class="anchor" id="line-989"></span><span class="anchor" id="line-990"></span><span class="anchor" id="line-991"></span></p><pre><span class="anchor" id="line-1-83"></span>When the poll shows that the zone has changed, then the secondary server
<span class="anchor" id="line-2-75"></span>must request a zone transfer via an AXFR request for the zone.  The AXFR
<span class="anchor" id="line-3-55"></span>may cause an error, such as refused, but normally is answered by a
<span class="anchor" id="line-4-49"></span>sequence of response messages.  The first and last messages must contain
<span class="anchor" id="line-5-37"></span>the data for the top authoritative node of the zone.  Intermediate
<span class="anchor" id="line-6-26"></span>messages carry all of the other RRs from the zone, including both
<span class="anchor" id="line-7-18"></span>authoritative and non-authoritative RRs.  The stream of messages allows
<span class="anchor" id="line-8-13"></span>the secondary to construct a copy of the zone.  Because accuracy is
<span class="anchor" id="line-9-8"></span>essential, TCP or some other reliable protocol must be used for AXFR
<span class="anchor" id="line-10-5"></span>requests.</pre><span class="anchor" id="line-992"></span><p class="line874">ゾーンが変更されたことが分ったら、 <span class="anchor" id="line-993"></span>セカンダリサーバはAXFRでゾーン転送を要求しなければならない。 <span class="anchor" id="line-994"></span>AXFR は拒否されるなど、エラーを起こすかもしれないが、 <span class="anchor" id="line-995"></span>通常は連続した返答メッセージが返ってきます。 <span class="anchor" id="line-996"></span>最初と最後のメッセージにはゾーンの権威あるトップノードのデータが <span class="anchor" id="line-997"></span>含まれているはずだ。 <span class="anchor" id="line-998"></span>途中のメッセージにはゾーンのすべての RRs が含まれていて、 <span class="anchor" id="line-999"></span>それには権威のあるものもないものもある。 <span class="anchor" id="line-1000"></span>メッセージの集合によって、 <span class="anchor" id="line-1001"></span>セカンダリはゾーンの複製を作ることができる。 <span class="anchor" id="line-1002"></span>正確さが重要なので、AXFR要求では TCPなどの信頼性の高いプロトコル <span class="anchor" id="line-1003"></span>を使わなくてはならない。 <span class="anchor" id="line-1004"></span><span class="anchor" id="line-1005"></span><span class="anchor" id="line-1006"></span><span class="anchor" id="line-1007"></span><span class="anchor" id="line-1008"></span><span class="anchor" id="line-1009"></span><span class="anchor" id="line-1010"></span><span class="anchor" id="line-1011"></span></p><pre><span class="anchor" id="line-1-84"></span>Each secondary server is required to perform the following operations
<span class="anchor" id="line-2-76"></span>against the master, but may also optionally perform these operations
<span class="anchor" id="line-3-56"></span>against other secondary servers.  This strategy can improve the transfer
<span class="anchor" id="line-4-50"></span>process when the primary is unavailable due to host downtime or network
<span class="anchor" id="line-5-38"></span>problems, or when a secondary server has better network access to an
<span class="anchor" id="line-6-27"></span>';intermediate'; secondary than to the primary.</pre><span class="anchor" id="line-1012"></span><p class="line874">各セカンダリサーバはあとに続く操作はマスターに対して行わなければならない。 <span class="anchor" id="line-1013"></span>ただし、他のセカンダリサーバに対してこれらの操作を行ってもよい。 <span class="anchor" id="line-1014"></span>この戦略はホストダウンやネットワークの問題でプライマリが利用できない時や、 <span class="anchor" id="line-1015"></span>プライマリよりも中間セカンダリの方がアクセスしやすい場合に <span class="anchor" id="line-1016"></span>転送プロセスを改善することができる。 <span class="anchor" id="line-1017"></span><span class="anchor" id="line-1018"></span></p><p class="line867"></p><hr><p class="line874"> <span class="anchor" id="line-1019"></span>2002-10-16 訳 前野年紀 <span class="anchor" id="line-1020"></span><span class="anchor" id="bottom"></span></p></div>
<div id="pagebottom"></div>
</div>


<div id="footer">
<ul class="editbar"><li><span class="disabled">編集不可のページ</span></li><li class="toggleCommentsButton" style="display:none;"><a href="https://moin.qmail.jp/DNS/RFC/1034/4#" class="nbcomment" onclick="toggleComments();return false;">コメント</a></li><li><a class="nbinfo" href="https://moin.qmail.jp/DNS/RFC/1034/4?action=info" rel="nofollow">情報</a></li><li><a class="nbattachments" href="https://moin.qmail.jp/DNS/RFC/1034/4?action=AttachFile" rel="nofollow">添付ファイル</a></li><li>
<form class="actionsmenu" method="GET" action="https://moin.qmail.jp/DNS/RFC/1034/4">
<div>
    
    <select name="action" onchange="if ((this.selectedIndex != 0) &amp;&amp;
                      (this.options[this.selectedIndex].disabled == false)) {
                this.form.submit();
            }
            this.selectedIndex = 0;">
        <option value="show">その他のアクション:</option><option value="raw">Wikiテキスト</option>
<option value="print">印刷ビュー</option>
<option value="RenderAsDocbook">Docbookで表示</option>
<option value="refresh">キャッシュ削除</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="SpellCheck">スペルチェック</option>
<option value="LikePages">似たページ</option>
<option value="LocalSiteMap">ローカルサイトマップ</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="RenamePage" disabled="" class="disabled">ページ名変更</option>
<option value="CopyPage">ページコピー</option>
<option value="DeletePage" disabled="" class="disabled">ページ削除</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="MyPages">マイページ</option>
<option value="show" disabled="" class="disabled">購読ユーザ追加</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="show" disabled="" class="disabled">スパム削除</option>
<option value="show" disabled="" class="disabled">このリビジョンに戻す</option>
<option value="PackagePages">ページパッケージ化</option>
<option value="SyncPages">ページ同期</option>
<option value="show" disabled="" class="disabled">------------------------</option>
<option value="CreateNewPage">CreateNewPage</option>
<option value="Load">ロード</option>
<option value="PageActions">PageActions</option>
<option value="Save">保存</option>
<option value="SlideShow">SlideShow</option>
<option value="Thumbnails">Thumbnails</option>
    </select>
    
    
</div>
<script type="text/javascript">
<!--// Init menu
actionsMenuInit('その他のアクション:');
//-->
</script>
</form>
</li></ul>

<ul id="credits">
<li><a href="http://moinmo.in/" title="This site uses the MoinMoin Wiki software.">MoinMoin Powered</a></li><li><a href="http://moinmo.in/Python" title="MoinMoin is written in Python.">Python Powered</a></li><li><a href="http://moinmo.in/GPL" title="MoinMoin is GPL licensed.">GPL licensed</a></li><li><a href="http://validator.w3.org/check?uri=referer" title="Click here to validate this page.">Valid HTML 4.01</a></li>
</ul>


</div>



</body></html>